<style>
.map-toggle .btn.btn-unstyled {
	bottom: .5em;
	font-size: 16px;
	font-weight: 600;
	letter-spacing: normal;
	position: absolute;
	right: 30px;
	text-transform: capitalize;
}

.map-toggle .btn.btn-unstyled .icon {
	height: 20px;
	width: 20px;
}

.map-toggle .iso-filters-desktop-expand {
	bottom: .5em;
	display: flex;
	position: absolute;
	right: 160px;
}

.icon.iso-filter {
	background-image: url('/content/dam/ecom/hosted/ico_filter_green.svg');
	background-position: center center;
	background-repeat: no-repeat;
	background-size: 100%;
	height: 20px;
	margin-right: 7px;
  	-webkit-transform: rotate(-90deg);
  	-moz-transform: rotate(-90deg);
  	-o-transform: rotate(-90deg);
  	-ms-transform: rotate(-90deg);
	transform: rotate(-90deg);
	vertical-align: bottom;
	width: 19px;
}

.icon.iso-book-icon {
	background-image: url('/content/dam/ecom/hosted/book_3.svg');
	background-position: center center;
	background-repeat: no-repeat;
	background-size: 100%;
	display: inline-block;
	height: 14px;
	margin-bottom: 2px;
	margin-right: 1px;
	vertical-align: bottom;
	width: 16px;
}

.iso-filters-desktop-expand .iso-filter-text {
	color: #169A5A;
	cursor: pointer;
  	font-size: 16px;
  	font-weight: 600;
}

.location-search-filter__mobile-header .location-search-filter__mobile-toggle-button {
	display: none;
}

.location-search-filter__mobile-header .iso-filters-mobile-expand {
	background-color: transparent;
	display: flex;
	float: right;
  	letter-spacing: normal;
  	margin: 0;
  	padding: 0;
  	text-transform: capitalize;
}

.location-search-filter__mobile-header .iso-filters-mobile-expand .iso-filter {
	height: 18px;
	width: 17px;
}

.location-search-filter__mobile-header .iso-filters-mobile-expand .iso-filter-text {
	color: #169A5A;
	cursor: pointer;
	font-size: 14px;
	font-weight: 600;
}

.icon.iso-filter-arrow {
	cursor: pointer;
	height: 12px;
	margin-left: 6px;
	margin-top: 5px;
	width: 12px;
}

.iso-modal-open {
	height: 100%;
	overflow: hidden;
}

.iso-modal.iso-location-filters-modal {
	display: none;
}

.iso-modal.iso-location-filters-modal.active {
	display: block;
}

.iso-modal.iso-location-filters-modal .location-search-filters-modal__description {
	font-size: 14px;
  	font-style: normal;
  	font-weight: 400;
  	margin-bottom: 18px;
}

.iso-modal.iso-location-filters-modal .ReactModal__Content--after-open.default-modal .modal-content .checkbox__label-checkbox {
	height: 24px;
	width: 24px;
}

.iso-modal.iso-location-filters-modal .ReactModal__Content--after-open.default-modal .modal-content .location-search-filters-modal__location-search-list li {
	padding-bottom: 16px;
}

.iso-modal.iso-location-filters-modal .ReactModal__Content--after-open.default-modal .modal-content .checkbox__label  {
	position: relative;
}

.iso-modal.iso-location-filters-modal .checkbox__label .checkbox__text .icon {
	display: inline-block;
	margin-left: 8px;
	position: absolute;
}

.iso-modal.iso-location-filters-modal .location-search-filters-modal__header {
	position: relative;
}

.iso-modal.iso-location-filters-modal .location-search-filters-modal__clear-all.btn {
	background:	transparent;
	color: #169a5a;
	font-size: .875rem;
	font-style: normal;
	font-weight: 700;
	padding: .25rem;
	position: absolute;
	right: -.25rem;
	top: .375rem;
	text-decoration: underline;
	text-transform: uppercase;
}

.iso-location-filters-modal.iso-modal .iso-modal-apply {
	float: right;
}

.iso-location-filters-modal.iso-modal .iso-modal-cancel {
	background-color: rgba(107, 107, 107, 1);
	border-color: rgba(107, 107, 107, 1) !important;
}

.iso-location-filters-modal.iso-modal .iso-modal-cancel:hover {
	background-color: rgba(54, 54, 54, 1);
	border-color: rgba(54, 54, 54, 1) !important;
}

.location-search .location-chicklet .location-chicklet-clear {
	display: none;
}

.location-search .location-chicklet .iso-location-chicklet-clear {
	background: #e6e6e6;
	cursor: pointer;
	display: table-cell;
	font-size: 1.1875rem;
	line-height: 1.1875rem;
	margin: 0 0;
	padding: 0.7em;
	vertical-align: middle;
}

.location-search .location-chicklet .iso-location-chicklet-clear .iso-icon-location-close {
	background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiMyMDlENUEiIGQ9Ik0zMiAzLjM2MkwyOC43NS4xMTIgMTYuMTk3IDEyLjY2OCAzLjY0Mi4xMTNsLTMuMjUgMy4yNSAxMi41NTUgMTIuNTU0TC4zOTMgMjguNDdsMy4yNSAzLjI1IDEyLjU1My0xMi41NTRMMjguNzUgMzEuNzIgMzIgMjguNDcgMTkuNDQ2IDE1LjkxOCIvPjwvc3ZnPg==');
	background-repeat: no-repeat;
	background-size: 100%;
	display: block;
	height: 16px;
	margin: 6px;
	width: 13px;
}

.location-search-filter__container.iso-hide {
	display: none;
}

.location-search-filter .location-search-filter__container {
	padding-right: 23px;
	padding-top: 18px;
}

.location-search-filter__container .location-search-filter__container-content {
	position: relative;
	width: 100%;
}

.location-search-filter__container .location-search-filter__container-content .iso-clear-btn {
	display: block;
	font-size: 16px;
	font-weight: 600;
	letter-spacing: normal;
	padding: 0;
	position: absolute;
	right: 0;
	top: 0;
}

.location-search-filter__container .location-search-filter__container-content .iso-clear-btn.iso-hide {
	display: none;
}

.location-search-filter__container .location-search-filter__container-content-header {
	color: #181918;
	display: inline-block;
	position: relative;
	top: -2px;
}

.location-search-filter__container .location-search-filter__container-content-header .location-search-filter__clear-all {
	margin-bottom: -10px;
	margin-left: 0;
	margin-top: -1px;
	position: absolute;
	white-space: nowrap;
}

.location-search-filter__container .location-search-filter__container-content-header {
	display: none !important;
}

.location-search-filter__container .location-search-filter__container-content-text {
	display: none !important;
}

.gi .location-search-filter__container-content-text.iso-filter-shown-text {
	display: block;
	font-weight: 400;
	margin-bottom: 0;
	padding-top: .625rem;
}

.gi .location-search-filter__container-content-text.iso-filter-shown-text strong {
	font-weight: 700;
}

.gi .location-search-filter__container-content-text.iso-filter-shown-text.iso-hide {
	display: none;
}

.location-search-filter__container .location-search-filter__vehicle-filter {
	display: inline-block;
	margin-left: 0px;
}

.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label,
.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label #location-search-open-time-filter,
.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label #location-search-after-hours-return-filter,
.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label #location-search-sunday-open-filter,
.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label .form-checkbox__text {
	display: inline-block;
}

.location-search-filter__container .location-search-filter__location-type-filter {
	display: inline-block;
	margin-left: 30px;
  	min-width: 12.5rem;
}

.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__label {
	margin-top: 0;
	padding-bottom: 0;
}

.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__label .location-type-filters-trigger__label-text {
	display: inline-block;
	font-size: .9375rem;
	font-style: normal;
	font-weight: 300;
  	text-transform: uppercase;
}

.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__button {
	font-style: normal;
	font-weight: 600;
	height: 3.125rem;
	margin-top: .1875rem;
	position: relative;
}

.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__button.disabled {
	background-color: #f3f3f3;
	color: #656565;
	cursor: not-allowed;
  	font-style: normal;
	font-weight: 300;
}

.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__button.btn .icon {
	display: block;
	height: .75rem;
	position: absolute;
	right: .375rem;
	top: 50%;
	transform: translateY(-50%) rotate(-90deg);
	width: .75rem;
}

.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__button.disabled .icon {
	display: none;
}

.search-results-wrapper .search-results ul .location-result-item.active[data-active="active"] {
	display: block;
}

.search-results-wrapper .search-results ul .location-result-item[data-active="hide"] {
	display: none;
}

.location-search-filter__mobile-header span {
	color: white;
}

.location-search-filter__mobile-header .iso-results-num {
	color: #797979;
	font-size: 14px;
	font-weight: 600;
	position: absolute;
}

@media (max-width: 900px) and (min-width: 769px) {
	.location-search-filter__container {
		padding: 1.5625rem .625rem 1.25rem;
	}
}

@media (max-width: 820px) and (min-width: 769px) {
	.location-search-filter__container .location-search-filter__location-type-filter {
		margin-left: 20px;
	}

	.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label {
		margin-left: 1.5rem;
	}
}

@media (max-width: 768px){
	.reservation-step .search-results-wrapper {
		background-color: #dbdbdb;
		-webkit-box-shadow: 0px -2px 2px rgba(0, 0, 0, 0.247058823529412);
	    box-shadow: 0px -2px 2px rgba(0, 0, 0, 0.247058823529412);
	}

	.reservation-step .search-results-wrapper .search-results { 
		margin-left: 6px;
	    margin-right: 6px;
	    min-width: 95%;
	}
	
	.location-search-filter__container .location-search-filter__container-content-header {
		display: flex;
	    font-size: 26px;
	    position: initial;
	    top: auto;
	}

	.location-search-filter__container .location-search-filter__container-content-header .location-search-filter__clear-all {
	    margin-bottom: auto;
	    margin-left: .625rem;
	    margin-top: auto;
	    position: initial;
	}

	.location-search-filter__container .vehicle-filters-trigger.location-search-filter__vehicle-filter {
		display: block;
		margin: 0 0 1.5625rem;
	}

	.location-search-filter__container .location-type-filters-trigger.location-search-filter__location-type-filter {
		display: block;
   		margin: 0 0 1.5625rem;
    	width: 12.5rem;
    	min-width: 12.5rem;
	}

	.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label {
		display: block;
	}
}
</style>
<script>
(function() {
	'use strict';
	var isoTest = {
		account : 'Enterprise',
		portfolio : 'Enterprise.com',
		test : 'Location Results Advanced Filter 2.0',
		creative : 'Challenger 1',
		selector : '.location-search-filter__container .location-search-filter__container-content',
		mapSelector : 'ENT-mappin-single-number-enterprise@2x',
		selectorLocations : '.search-results-wrapper .search-results ul .location-result-item.active',
		mapChangeSelector : '[aria-live=off]',
		content : '<div class="location-type-filters-trigger location-search-filter__location-type-filter">\
						<label class="location-type-filters-trigger__label" for="location-type-filters-trigger">\
							<span class="location-type-filters-trigger__label-text">LOCATION TYPE</span>\
						</label>\
						<button class="btn location-type-filters-trigger__button btn-input" tabindex="0" type="button" role="button" name="location-type-filters-trigger">All Locations<i class="icon icon-nav-carrot-down"></i></button>\
					</div>',
		modal : '<div class="iso-location-filters-modal iso-modal" >\
					<div class="ReactModal__Overlay ReactModal__Overlay--after-open modal-overlay fixed-overlay" aria-modal="true">\
						<div class="ReactModal__Content ReactModal__Content--after-open default-modal fixed-scroll-modal" tabindex="-1" role="dialog" aria-describedby="modal-context">\
							<div class="modal-inner">\
								<div class="modal-header">\
									<button class="close-modal" aria-label="Close" role="button" type="button"><i class="icon icon-close-x-white" aria-hidden="true">X</i></button>\
								</div>\
								<div class="modal-content cf">\
									<div class="location-search-filters-modal" id="modal-context">\
										<div class="location-search-filters-modal__header">\
											<h2 class="location-search-filters-modal__title">Location Type</h2>\
											<button class="btn location-search-filters-modal__clear-all iso-clear-location-filter" tabindex="0" type="button" role="button">Clear All</button>\
										</div>\
										<p class="location-search-filters-modal__description">Select the location type(s) you want to search by.</p>\
										<div class="location-search-filters-modal__location-search-list">\
											<ul>\
												<li>\
													<label class="checkbox__label " tabindex="0" id="checkbox_location_1" aria-checked="false" role="checkbox">\
														<span class="checkbox__label-checkbox" id="airport">\
															<input class="location-type-checkbox" type="checkbox" name="location-search" value="Airport Locations">\
															<i class="icon icon-check-green"></i>\
														</span>\
														<span class="checkbox__text">Airport Locations<i class="icon location-type-icon icon-location-airport" aria-label="Airport"></i></span>\
													</label>\
												</li>\
												<li>\
													<label class="checkbox__label " tabindex="0" id="checkbox_location_2" aria-checked="false" role="checkbox">\
														<span class="checkbox__label-checkbox" id="city">\
															<input class="location-type-checkbox" type="checkbox" name="location-search" value="City Locations">\
															<i class="icon icon-check-green"></i>\
														</span>\
														<span class="checkbox__text">City Locations<i class="icon location-type-icon icon-location-city" aria-label="City"></i></span>\
													</label>\
												</li>\
												<li>\
													<label class="checkbox__label" tabindex="0" id="checkbox_location_3" aria-checked="false" role="checkbox">\
														<span class="checkbox__label-checkbox" id="exotics">\
															<input class="location-type-checkbox" type="checkbox" name="location-search" value="Exotics Locations">\
															<i class="icon icon-check-green"></i>\
														</span>\
														<span class="checkbox__text">Exotics Locations<i class="icon location-type-icon icon-icon-exotics" aria-label="Exotics"></i></span>\
													</label>\
												</li>\
												<li>\
													<label class="checkbox__label " tabindex="0" id="checkbox_location_4" aria-checked="false" role="checkbox">\
														<span class="checkbox__label-checkbox"  id="port_of_call">\
															<input class="location-type-checkbox" type="checkbox" name="location-search" value="Port Locations">\
															<i class="icon icon-check-green"></i>\
														</span>\
														<span class="checkbox__text">Port Locations<i class="icon location-type-icon icon-location-port_of_call" aria-label="Port of Call"></i></span>\
													</label>\
												</li>\
												<li>\
													<label class="checkbox__label " tabindex="0" id="checkbox_location_5" aria-checked="false" role="checkbox">\
														<span class="checkbox__label-checkbox" id="rail">\
															<input class="location-type-checkbox" type="checkbox" name="location-search" value="Train Station Locations">\
															<i class="icon icon-check-green"></i>\
														</span>\
														<span class="checkbox__text">Train Station Locations<i class="icon location-type-icon icon-location-rail" aria-label="Rail"></i></span>\
													</label>\
												</li>\
											</ul>\
										</div>\
									</div>\
									<div class="modal-buttons-container ">\
										<button class="btn modal-button iso-modal-apply" type="button" role="button">Apply</button>\
										<button class="btn modal-button iso-modal-cancel" type="button" role="button">Cancel</button>\
									</div>\
								</div>\
						  </div>\
						</div>\
					</div>\
				</div>',
		noMatches : "<li class='location-result-item location-result-item--no-result active location-result-item--filter-applied iso-no-active-items' data-active='inactive'>\
						<div class='location-result-item__content-container'>\
							<p class='location-result-item__content-container-text'><span>Sorry, we couldn't find any locations matching your search criteria.  Please adjust filters.</span></p>\
						</div>\
					</li>",
		additionalFilters : '<label class="location-search-filter__container-filter form-checkbox__label" tabindex="0" for="location-search-sunday-open-filter" role="checkbox">\
								<input type="checkbox" tabindex="-1" name="location-search-sunday-open-filter" id="location-search-sunday-open-filter" class="form-checkbox__input" value="on">\
								<span class="form-checkbox__box-ui"><i class="icon icon-check-green"></i></span>\
								<span class="form-checkbox__text">Open Sunday</span>\
							</label>\
							<label class="location-search-filter__container-filter form-checkbox__label" tabindex="0" for="location-search-after-hours-return-filter" role="checkbox">\
								<input type="checkbox" tabindex="-1" name="location-search-after-hours-return-filter" id="location-search-after-hours-return-filter" class="form-checkbox__input" value="on">\
								<span class="form-checkbox__box-ui"><i class="icon icon-check-green"></i></span>\
								<span class="form-checkbox__text">After Hours return available</span>\
							</label>',
		clearBtn : '<button class="btn location-search-filter__clear-all btn-unstyled" tabindex="0" type="button" role="button">Clear All</button>',
		tabbableElements : 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]',
		checkedFilters : {
			airport : 'false',
			city : 'false',
			exotics : 'false',
			port_of_call : 'false',
			rail : 'false'
		},
		counter : '',
		sundaycounter : '',
		locationsNumber : '',
		filtersCheckedNumber : '0',
		init : function() {

			isoTest.debug = ${user.mvtDebug};

			if (_satellite && typeof _satellite.setVar === 'function' && typeof _satellite.track === 'function') {
				_satellite.setVar('TargetCampaign', isoTest.test);
				_satellite.setVar('TargetCreative', isoTest.creative);
				//_satellite.track('target_variables');
			}

			isoTest.log('Test Running...');
			isoTest.log(isoTest.account + ' - ' + isoTest.portfolio);
			isoTest.log(isoTest.test + ' - ' + isoTest.creative);

			helpers.elementLoaded(isoTest.selectorLocations, function() {
				isoTest.log('Test Ready!');
  				isoTest.chall();
			});

			window.addEventListener('hashchange', isoTest.viewChange, false);

		},
		viewChange : function(){
			if(/location/.test(location.hash)){
				helpers.elementLoaded(isoTest.selectorLocations, function() {
					isoTest.chall();
				});
			} else {
				if (document.querySelector('.iso-location-filters-modal.iso-modal') != null) {
					window.clearInterval(isoTest.counter);
					document.querySelector('.iso-location-filters-modal.iso-modal').remove();
				}
			}
		},
		chall : function() {
			isoTest.log('chall()');

			helpers.elementLoaded('.location-search-filter__mobile-header span', function() {
				isoTest.addLocationFilter();
				isoTest.addFilterModal();
				isoTest.addLocationClearIcon();
				isoTest.addLocationExpand();
				isoTest.addAttributeToAllLocations();
				isoTest.addEvents();
				isoTest.checkForSearchByVehicleOnLoad();
			});
		},
		addLocationExpand : function() {
			isoTest.log('addLocationExpand()');

			if (document.querySelector('.map-toggle') && !document.querySelector('.map-toggle .iso-filters-desktop-expand')) {
				document.querySelector('.map-toggle').insertAdjacentHTML('afterbegin','<div class="iso-filters-desktop-expand"><i class="icon iso-filter"></i><span class="iso-filter-text">Filter</span><i class="icon iso-filter-arrow icon-nav-carrot-down"></i></div>');
			}

			if (document.querySelector('.gi .location-search__max-result-error') && !document.querySelector('.gi .iso-filter-shown-text')) {
				document.querySelector('.gi .location-search__max-result-error').insertAdjacentHTML('afterend', '<p class="location-search-filter__container-content-text desktop iso-filter-shown-text iso-hide"><i class="icon iso-book-icon"></i>Results below reflect locations that have <strong>your selected Vehicle Class</strong> available.</p>');
			}

			if (document.querySelector('.location-search-filter__container-content') && !document.querySelector('.location-search-filter__container-content .iso-clear-btn')) {
				document.querySelector('.location-search-filter__container-content').insertAdjacentHTML('beforeend', '<button class="btn location-search-filter__clear-all btn-unstyled iso-clear-btn iso-hide" tabindex="0" type="button" role="button">Clear All</button>');
			}

			if (!document.querySelector('.location-search-filter__mobile-header .iso-filters-mobile-expand')) {
				document.querySelector('.location-search-filter__mobile-header .location-search-filter__mobile-toggle-button').insertAdjacentHTML('afterend','<button class="iso-filters-mobile-expand"><i class="icon iso-filter"></i><span class="iso-filter-text">Filter</span><i class="icon iso-filter-arrow icon-nav-carrot-down"></i></button>');
			}

			if (document.querySelector('.location-search-filter__container')) {
				document.querySelector('.location-search-filter__container').classList.add('iso-hide');
			}
		},
		checkForSearchByVehicleOnLoad : function() {
			isoTest.log('checkForSearchByVehicleOnLoad()');

			if (document.querySelector('.vehicle-filters-trigger__button').innerText != "All Vehicles") {
				document.querySelector('.location-search-filter .location-search-filter__mobile-toggle-button').click();

				var mobileFilterArrow = document.querySelector('.iso-filters-mobile-expand .icon.iso-filter-arrow');
				var desktopFilter = document.querySelector('.location-search-filter__container');
				var desktopFilterArrow = document.querySelector('.iso-filters-desktop-expand .icon.iso-filter-arrow');

				mobileFilterArrow.classList.add('icon-nav-carrot-up-green');
				mobileFilterArrow.classList.remove('icon-nav-carrot-down');
				desktopFilter.classList.remove('iso-hide');
				desktopFilterArrow.classList.add('icon-nav-carrot-up-green');
				desktopFilterArrow.classList.remove('icon-nav-carrot-down');

				document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').classList.remove('iso-hide');
				document.querySelector('.gi .location-search-filter__container-content-text.desktop.iso-filter-shown-text').classList.remove('iso-hide');

				document.querySelector('.iso-filters-desktop-expand .iso-filter-text').innerHTML = "Filter (1)";
				document.querySelector('.iso-filters-mobile-expand .iso-filter-text').innerHTML = "Filter (1)";

				isoTest.checkResultsUpdateForSearchByVehicle();
			}
		},
		checkResultsUpdateForSearchByVehicle : function() {
			isoTest.log('checkResultsUpdateForSearchByVehicle()');

			var checkResultsChange = setInterval(function(){
				var locationsNumberCheck = document.querySelectorAll('.search-results-wrapper .search-results ul .location-result-item[data-active="active"]').length;

				if (locationsNumberCheck != isoTest.locationsNumber) {
					clearInterval(checkResultsChange);

					isoTest.locationsNumber = document.querySelectorAll('.search-results-wrapper .search-results ul .location-result-item[data-active="active"]').length;
					document.querySelector('.iso-results-num').innerHTML = isoTest.locationsNumber + " RESULTS";
				}
			},100);

			setTimeout(function(){
				clearInterval(checkResultsChange);
			}, 6000);
		},
		addLocationFilter : function() {
			isoTest.log('addLocationFilter()');

			var vehicleFilterHeader = document.querySelector('.location-search-filter__container .location-search-filter__container-content-header');

			var vehicleTypeFilter = document.querySelector('.location-search-filter__container .location-search-filter__vehicle-filter');

			var openCheckbox = document.querySelector('.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label');

			vehicleFilterHeader.after(vehicleTypeFilter);

			vehicleTypeFilter.after(openCheckbox);

			if (document.querySelector('.location-search-filter__location-type-filter') == null) {
				vehicleTypeFilter.insertAdjacentHTML('afterend', isoTest.content);
			}

			if (document.querySelector('#location-search-sunday-open-filter') == null) {
				openCheckbox.insertAdjacentHTML('beforebegin', isoTest.additionalFilters);
			}
		},
		addFilterModal : function() {
			isoTest.log('addFilterModal()');

			if (document.querySelector('.iso-location-filters-modal.iso-modal') == null) {
				document.querySelector('#ip-redirect').insertAdjacentHTML("afterend", isoTest.modal);
			}
		},
		addAttributeToAllLocations : function() {
			isoTest.log('addAttributeToAllLocations()');
			
			var allLocations = document.querySelectorAll('.search-results-wrapper .search-results ul .location-result-item.active');

			for(var i = 0; i < allLocations.length; i++) {
				allLocations[i].setAttribute('data-active', 'active');
			}

			isoTest.locationsNumber = document.querySelectorAll('.search-results-wrapper .search-results ul .location-result-item[data-active="active"]').length;

			if (document.querySelector('.iso-results-num') == null) {
				document.querySelector('.location-search-filter__mobile-header span').insertAdjacentHTML('beforebegin','<span class="iso-results-num">'+isoTest.locationsNumber+' RESULTS</span>');
			} else {
				document.querySelector('.iso-results-num').innerHTML = isoTest.locationsNumber + " RESULTS";
			}
		},
		addLocationClearIcon : function() {
			isoTest.log('addLocationClearIcon()');

			helpers.elementLoaded('.location-chicklet-clear', function() {
				if (document.querySelector('.iso-location-chicklet-clear') == null) {
					document.querySelector('.location-chicklet-clear').insertAdjacentHTML('beforebegin','<div class="iso-location-chicklet-clear" tabindex="0" role="button"><i class="iso-icon-location-close"></i></div>');
				}
			});
		},
		checkForFilters : function() {
			isoTest.log("checkForFilters()");

			var checkedLocations = document.querySelectorAll('.checkbox__label-checkbox');

			if (document.querySelectorAll('.checkbox__label-checkbox.checked').length > 0) {
				var checkedLength = document.querySelectorAll('.checkbox__label-checkbox.checked').length;

				if (isoTest.filtersCheckedNumber != checkedLength) {
					isoTest.filtersCheckedNumber = checkedLength;
					document.querySelector('.location-type-filters-trigger__button').innerHTML = 'Locations ('+checkedLength+')<i class="icon icon-nav-carrot-down"></i>';
				}

				for(var i = 0; i < checkedLocations.length; i++) {
					var checkedLocationID = checkedLocations[i].id;

					if (!checkedLocations[i].classList.contains('checked')) {
						isoTest.checkedFilters[checkedLocationID] = 'false';
						isoTest.updatePage(checkedLocationID, 'unchecked');
					} else {
						isoTest.checkedFilters[checkedLocationID] = 'true';
						isoTest.updatePage(checkedLocationID,'checked');
					}
				}
			} else {
				if (isoTest.filtersCheckedNumber != 0) {
					isoTest.filtersCheckedNumber = 0;
					document.querySelector('.location-type-filters-trigger__button').innerHTML = 'All Locations<i class="icon icon-nav-carrot-down"></i>';
				}

				for(var x = 0; x < checkedLocations.length; x++) {
					var uncheckedboxLocationID = checkedLocations[x].id;
					isoTest.checkedFilters[uncheckedboxLocationID] = 'false';
					isoTest.updatePage(uncheckedboxLocationID,'checked');
				}

				window.clearInterval(isoTest.counter);
			}

			isoTest.updateClearBtn();
			isoTest.updateOrder();
			isoTest.updateFilterAmount();
		},
		updateClearBtn: function(){
			isoTest.log("updateClearBtn()");

			var filterHeader = document.querySelector('.location-search-filter__container-content-header');
			var vehicleTypeFilter = document.querySelector('.vehicle-filters-trigger__button');
			var hasLocations = document.querySelectorAll('.checkbox__label-checkbox.checked').length > 0;
			var isChecked = document.querySelector('#location-search-open-time-filter:checked');
			var sundayIsChecked = document.querySelector('#location-search-sunday-open-filter:checked');
			isoTest.log(filterHeader);
			isoTest.log(vehicleTypeFilter);
			isoTest.log(hasLocations);

			if(!filterHeader.querySelector('.location-search-filter__clear-all')){
				if(vehicleTypeFilter.innerText == 'All Vehicles' && (hasLocations || sundayIsChecked)){
					filterHeader.insertAdjacentHTML('beforeend',isoTest.clearBtn);
					document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').classList.remove('iso-hide');
				}
			} else {
				if(vehicleTypeFilter.innerText == 'All Vehicles' && !hasLocations && !isChecked && !sundayIsChecked){
					var clearBtn = filterHeader.querySelector('.location-search-filter__clear-all');
					filterHeader.removeChild(clearBtn);
					document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').classList.add('iso-hide');
				}
			}
		},
		updatePage : function(image, status) {
			isoTest.log("updatePage()");

			var allLocations = document.querySelectorAll('.search-results-wrapper .search-results ul .location-result-item');

			if (allLocations.length > 0) {
				var search;
				var imgSearch = image;

				if (image == "city") {
					imgSearch = isoTest.mapSelector;
				}

				for(var i = 0; i < allLocations.length; i++) {
					if (image == "city") {
						search = !allLocations[i].querySelector('.location-name i.icon');
					} else {
						search = allLocations[i].querySelector('[class*="'+ image +'"]');
					}

					if (search && !allLocations[i].classList.contains('location-result-item--no-result')) {
						if (status == "unchecked") {
							allLocations[i].setAttribute('data-active', 'hide');
						} else {
							allLocations[i].setAttribute('data-active', 'active');
						}
						var locationID = allLocations[i].querySelector('.location-result-item__cta.btn').id;

						helpers.elementLoaded('div[class*="'+ locationID +'"]', function() {
							var mapData = document.querySelectorAll('div[class*="'+ locationID +'"]');
							for(var x = 0; x < mapData.length; x++) {
								if (status == "unchecked") {
									mapData[x].style.display = "none";
								} else {
									mapData[x].style.display = "block";
								}
							}
						});
					}
				}

		    	helpers.elementLoaded('img[src*="'+imgSearch+'"]', function() {
		      		var selectedImages = document.querySelectorAll('img[src*="'+imgSearch+'"]');
					for(var i = 0; i < selectedImages.length; i++) {
						if (status == "unchecked") {
							selectedImages[i].parentNode.style.display = 'none';
							selectedImages[i].style.display = 'none';
						} else {
							selectedImages[i].parentNode.style.display = 'block';
							selectedImages[i].style.display = 'block';
						}
					}
				});
			}
		},
		updateOrder : function() {
			isoTest.log('updateOrder()');

			var allLocations = document.querySelectorAll('.search-results-wrapper .search-results ul .location-result-item[data-active="active"]');
			var noResults = document.querySelectorAll('.location-result-item--no-result');

			if (allLocations.length > 0) {
				if (document.querySelector('.iso-no-active-items')) {
					document.querySelector('.iso-no-active-items').remove();
				}

				for(var i = 0; i < allLocations.length; i++) {
					allLocations[i].querySelector('.location-index').innerHTML = i + 1;

					var locationID = allLocations[i].querySelector('.location-result-item__cta.btn').id;
					var mapData = document.querySelectorAll('div[class*="'+ locationID +'"]');

					for(var a = 0; a < mapData.length; a++) {
						mapData[a].innerHTML = i + 1;
					}
				}

				if (isoTest.locationsNumber != allLocations.length) {
					isoTest.locationsNumber = allLocations.length;
					isoTest.updateFilteredNumber();
				}
			} else {
				if (isoTest.locationsNumber != 0) {
					isoTest.locationsNumber = 0;
					isoTest.updateFilteredNumber();
				}

				if (document.querySelector('.search-results-wrapper .search-results ul')) {
					if (noResults.length == 0) {
						document.querySelector('.search-results-wrapper .search-results ul').insertAdjacentHTML('afterbegin', isoTest.noMatches);
					}

					if (noResults.length > 1) {
						document.querySelector('.iso-no-active-items').remove();
					}
				}
			}
		},
		checkModalForChange : function() {
			isoTest.log("checkModalForChange()");

			for (var key in isoTest.checkedFilters) {
				var filterEl = document.getElementById(key);

				if (isoTest.checkedFilters[key] == "false") {
					if (filterEl.classList.contains('checked')) {
						filterEl.classList.remove('checked');
					}
				} else {
					if (!filterEl.classList.contains('checked')) {
						filterEl.classList.add('checked');
					}
				}
			}
		},
		updateFilterExpand : function() {
			isoTest.log("updateFilterExpand()");

			var desktopFilter = document.querySelector('.location-search-filter__container');
			var mobileExpand = document.querySelector('.location-search-filter');

			if (desktopFilter.classList.contains('iso-hide')) {
				if (!mobileExpand.classList.contains('mobile-expanded')) {
					document.querySelector('.location-search-filter .location-search-filter__mobile-toggle-button').click();
				}

				isoTest.updateMobileDesktopExpand();
			} else {
				if (mobileExpand.classList.contains('mobile-expanded')) {
					document.querySelector('.location-search-filter .location-search-filter__mobile-toggle-button').click();
				}

				isoTest.updateMobileDesktopCollapse();
			}
		},
		updateFilterExpandMobile : function() {
			isoTest.log("updateFilterExpandMobile()");

			var mobileExpand = document.querySelector('.location-search-filter');

			if (mobileExpand.classList.contains('mobile-expanded')) {
				isoTest.updateMobileDesktopExpand();
			} else {
				isoTest.updateMobileDesktopCollapse();
			}
		},
		updateMobileDesktopExpand : function() {
			isoTest.log("updateMobileDesktopExpand()");

			isoTest.fireTag('.iso-filter-text','Filter CTA - Expand');

			var mobileFilterArrow = document.querySelector('.iso-filters-mobile-expand .icon.iso-filter-arrow');
			var desktopFilter = document.querySelector('.location-search-filter__container');
			var desktopFilterArrow = document.querySelector('.iso-filters-desktop-expand .icon.iso-filter-arrow');

			mobileFilterArrow.classList.add('icon-nav-carrot-up-green');
			mobileFilterArrow.classList.remove('icon-nav-carrot-down');
			desktopFilter.classList.remove('iso-hide');
			desktopFilterArrow.classList.add('icon-nav-carrot-up-green');
			desktopFilterArrow.classList.remove('icon-nav-carrot-down');
		},
		updateMobileDesktopCollapse : function() {
			isoTest.log("updateMobileDesktopCollapse()");

			isoTest.fireTag('.iso-filter-text','Filter CTA - Collapse');

			var mobileFilterArrow = document.querySelector('.iso-filters-mobile-expand .icon.iso-filter-arrow');
			var desktopFilter = document.querySelector('.location-search-filter__container');
			var desktopFilterArrow = document.querySelector('.iso-filters-desktop-expand .icon.iso-filter-arrow');

			mobileFilterArrow.classList.add('icon-nav-carrot-down');
			mobileFilterArrow.classList.remove('icon-nav-carrot-up-green');
			desktopFilter.classList.add('iso-hide');
			desktopFilterArrow.classList.add('icon-nav-carrot-down');
			desktopFilterArrow.classList.remove('icon-nav-carrot-up-green');
		},
		updatePageSundayOpen : function(status) {
			// isoTest.log("updatePageSundayOpen()");

			var solr = _analytics.solr;
			solr.forEach(function(loc){
			    // console.log('sundays::: ' + loc.openSundays)
			    // console.log('id::: ' + loc.peopleSoftId)
			    
			    if(!loc.openSundays){
			        document.querySelectorAll('.map-labels[class*="'+loc.peopleSoftId+'"]').forEach(function(lbl){
			            var indx= helpers.getIndex(lbl);
			            var lblParent = lbl.parentNode;
			            var lblCount = lblParent.querySelectorAll('.map-labels').length;
			            var lblIcon = lblParent.childNodes[lblCount + indx];
			            // console.log(indx)
			            // console.log(lbl);
			            // console.log(lblIcon);

        				if (status === "checked") {
							lbl.style.display = 'none';
			            	lblIcon.style.display = 'none';
						} else {
							lbl.style.display = 'block';
			            	lblIcon.style.display = 'block';
						}

			   //          var allLocations = document.querySelectorAll('.search-results-wrapper .search-results ul .location-result-item');

						// if (allLocations.length > 0) {
						// 	for(var i = 0; i < allLocations.length; i++) {
						// 		if (!allLocations[i].classList.contains('location-result-item--no-result')) {
						// 			var locationID = allLocations[i].querySelector('.location-result-item__cta.btn').id;

						// 			helpers.elementLoaded('div[class*="'+ locationID +'"]', function() {
						// 				var mapData = document.querySelectorAll('div[class*="'+ locationID +'"]');
						// 				for(var x = 0; x < mapData.length; x++) {
						// 					if (status == "checked") {
						// 						mapData[x].style.display = "none";
						// 					} else {
						// 						mapData[x].style.display = "block";
						// 					}
						// 				}

						// 				if (locationID == loc.peopleSoftId) {
						// 					if (status === "checked") {
						// 						allLocations[i].setAttribute('data-active', 'hide');
						// 					} else {
						// 						allLocations[i].setAttribute('data-active', 'active');
						// 					}
						// 				}
						// 			});

						// 		}
						// 	}
						// }
			        });
			    }   
			});

			isoTest.updateClearBtn();
			isoTest.updateOrder();
			isoTest.updateFilterAmount();
		},
		addEvents : function() {
			isoTest.log("addEvents()");

			document.querySelector('#location-search-sunday-open-filter').addEventListener('click', function(e){
				isoTest.updatePageSundayOpen();

				if (document.querySelector('#location-search-sunday-open-filter:checked')) {
					// isoTest.log('checked');
					window.setInterval(function(){isoTest.updatePageSundayOpen("checked");},100);
				} else {
					// isoTest.log('unchecked');
					isoTest.updatePageSundayOpen("unchecked");
					window.clearInterval(isoTest.sundaycounter);
				}

				// isoTest.updateFilterAmount();

				// var filterAmtVehicles = (document.querySelector('.vehicle-filters-trigger__button').innerText != "All Vehicles" ? 1 : 0);
				// var filterAmtLocations = document.querySelectorAll('.checkbox__label-checkbox.checked').length;

				// if (document.querySelector('#location-search-open-time-filter:checked')) {
				// 	document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').classList.remove('iso-hide');
				// } else {
				// 	if ( filterAmtVehicles == 0 && filterAmtLocations == 0 ) {
				// 		document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').classList.add('iso-hide');
				// 	}
				// }

				// window.setTimeout(function(){
				// 	isoTest.checkForFilters();
				// 	isoTest.updateOrder();
				// 	isoTest.updateFilteredNumber();
				// }, 500);
			}, false);

			document.querySelector('.iso-filters-desktop-expand').addEventListener('click', function (e) {
				isoTest.updateFilterExpand();
			}, false);

			document.querySelector('.iso-filters-mobile-expand').addEventListener('click', function (e) {
				document.querySelector('.location-search-filter .location-search-filter__mobile-toggle-button').click();
				window.setTimeout(function(){
					isoTest.updateFilterExpandMobile();
				}, 100);
				
			}, false);

			document.querySelector('.iso-modal.iso-location-filters-modal .close-modal').addEventListener('click', function (e) {
				isoTest.fireTag('.close-modal','Filter Location Type: Close Icon');
				isoTest.checkModalForChange();
				isoTest.destroyModal();
			}, false);

			document.querySelector('.location-search-filter__container .location-type-filters-trigger__button').addEventListener('click', function (e) {
				isoTest.fireTag('.location-type-filters-trigger__button','Filter Location Type: Open Modal');
				isoTest.modalOpen();
			}, false);

			document.querySelector('.iso-location-filters-modal.iso-modal .iso-modal-apply').addEventListener('click', function(e){
				var allchecked = document.querySelectorAll('.iso-location-filters-modal.iso-modal .checkbox__label-checkbox.checked');
				var checkedString = 'Filter Location Type: ';
				if (allchecked.length > 0) {
					for (var i = 0; i < allchecked.length; i++) {
						var val = allchecked[i].querySelector('.location-type-checkbox').value;
						if (checkedString == 'Filter Location Type: ') {
							checkedString += val;
						} else {
							checkedString += ', ' + val;
						}
					}
				} else {
					checkedString += 'Filters Cleared';
				}

				isoTest.fireTagApply('.iso-modal-apply','Filter Location Type: Apply CTA', checkedString);
				isoTest.destroyModal();
			}, false);

			document.querySelector('.iso-location-filters-modal.iso-modal .iso-modal-cancel').addEventListener('click', function(e){
				isoTest.fireTag('.iso-modal-cancel','Filter Location Type: Cancel CTA');
				isoTest.checkModalForChange();
				isoTest.destroyModal();
			}, false);

			document.querySelector('.iso-location-filters-modal.iso-modal .iso-clear-location-filter').addEventListener('click', function(e){
				var allchecked = document.querySelectorAll('.iso-location-filters-modal.iso-modal .checkbox__label-checkbox.checked');
				if (allchecked.length > 0) {
					for (var i = 0; i < allchecked.length; i++) {
						allchecked[i].classList.remove('checked');
					}
					isoTest.fireTag('.iso-clear-location-filter','Filter Location Type: Clear Filter');
				}
			}, false);

			document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').addEventListener('click', function(e){
				document.querySelector('.location-search-filter__container-content-header .location-search-filter__clear-all').click();
				document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').classList.add('iso-hide');
				document.querySelector('.gi .location-search-filter__container-content-text.desktop.iso-filter-shown-text').classList.add('iso-hide');
				document.querySelector('.iso-filters-desktop-expand .iso-filter-text').innerHTML = "Filter";
				document.querySelector('.iso-filters-mobile-expand .iso-filter-text').innerHTML = "Filter";
			}, false);

			document.querySelector('#location-search-open-time-filter').addEventListener('click', function(e){
				isoTest.updateFilterAmount();

				var filterAmtVehicles = (document.querySelector('.vehicle-filters-trigger__button').innerText != "All Vehicles" ? 1 : 0);
				var filterAmtLocations = document.querySelectorAll('.checkbox__label-checkbox.checked').length;

				if (document.querySelector('#location-search-open-time-filter:checked')) {
					document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').classList.remove('iso-hide');
				} else {
					if ( filterAmtVehicles == 0 && filterAmtLocations == 0 ) {
						document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').classList.add('iso-hide');
					}
				}

				window.setTimeout(function(){
					isoTest.checkForFilters();
					isoTest.updateOrder();
					isoTest.updateFilteredNumber();
				}, 500);
			}, false);


			document.querySelector('.resflow-location').addEventListener('click', function (event) {
				// isoTest.log(event.target);

				// if (event.target.classList.contains('modal-button')) {
				// 	isoTest.updateFilteredNumber();
				// }

				if (event.target.classList.contains('modal-button') && !event.target.classList.contains('iso-modal-apply') && !event.target.classList.contains('iso-modal-cancel')) {
					window.setTimeout(function(){
						if (document.querySelector('.location-search-filter__container-content-header .location-search-filter__clear-all')) {
							document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').classList.remove('iso-hide');
						} else {
							document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').classList.add('iso-hide');
						}

						if (document.querySelector('.vehicle-filters-trigger__button').innerText != "All Vehicles") {
							document.querySelector('.gi .location-search-filter__container-content-text.desktop.iso-filter-shown-text').classList.remove('iso-hide');
						} else {
							document.querySelector('.gi .location-search-filter__container-content-text.desktop.iso-filter-shown-text').classList.add('iso-hide');
						}

						isoTest.checkForFilters();
						isoTest.updateOrder();
						isoTest.updateFilterAmount();
					}, 100);
				}

				if (event.target.classList.contains('iso-location-chicklet-clear') || event.target.classList.contains('iso-icon-location-close')) {
					isoTest.updateForNewLocation();
				}

				if (event.target.classList.contains('location-result-item__cta')) {
					window.clearInterval(isoTest.counter);
					if (isoTest.filtersCheckedNumber != 0) {
						isoTest.filtersCheckedNumber = 0;
						document.querySelector('.location-type-filters-trigger__button').innerHTML = 'All Locations<i class="icon icon-nav-carrot-down"></i>';
					}

					var allchecked = document.querySelectorAll('.iso-location-filters-modal.iso-modal .checkbox__label-checkbox.checked');
					if (allchecked.length > 0) {
						for (var i = 0; i < allchecked.length; i++) {
							allchecked[i].classList.remove('checked');
						}
					}

					for (var key in isoTest.checkedFilters) {
						isoTest.checkedFilters[key] = "false";
					}

					isoTest.filtersCheckedNumber = 0;
				}

				if (event.target.classList.contains('location-search-filter__clear-all')) {
					var allcheckedBoxes = document.querySelectorAll('.iso-location-filters-modal.iso-modal .checkbox__label-checkbox.checked');
					if (allcheckedBoxes.length > 0) {
						for (var b = 0; b < allcheckedBoxes.length; b++) {
							allcheckedBoxes[b].classList.remove('checked');
						}
						isoTest.checkForFilters();
					}

					isoTest.checkForFilters();
					isoTest.updateOrder();
					isoTest.updateFilteredNumber();
				}

				//Tracking
				if (event.target.name == 'location-search') {
					isoTest.fireTag(event.target, 'Filter Location Type: ' + event.target.value);
				}

			}, false);

			document.addEventListener("keydown", function (e) {
				var keyCode = (e.keyCode ? e.keyCode : e.which);

		        if (keyCode == '27') {
		        	if (document.querySelector('html').classList.contains('iso-modal-open')) {
		          		isoTest.fireTag('esc','Filter Location Type: Close');
		            	isoTest.destroyModal();
		        	}
		        }
			}, false);

			var filterElements = document.querySelectorAll('.iso-location-filters-modal.iso-modal .location-search-filters-modal__location-search-list .checkbox__label .location-type-checkbox');
			
			for(var i = 0; i < filterElements.length; i++) {
				// isoTest.log("Filter Elements: " + filterElements[i]);
				filterElements[i].addEventListener('click', function(e){
					// isoTest.log('clicked checkbox');
					// isoTest.log(e.target.parentNode.classList);
					if (e.target.parentNode.classList.contains('checked')) {
						// isoTest.log('checked');
						e.target.parentNode.classList.remove('checked');
					} else {
						// isoTest.log('not checked');
						e.target.parentNode.classList.add('checked');
					}
		    	}, false);
			}
		},
		updateFilterAmount : function () {
			isoTest.log("updateFilterAmount()");

			var filterTextElDesktop = document.querySelector('.iso-filters-desktop-expand .iso-filter-text');
			var filterTextElMobile = document.querySelector('.iso-filters-mobile-expand .iso-filter-text');
			var filterAmtVehicles = (document.querySelector('.vehicle-filters-trigger__button').innerText != "All Vehicles" ? 1 : 0);
			var filterAmtLocations = document.querySelectorAll('.checkbox__label-checkbox.checked').length;
			var filterAmtCheckbox = (document.querySelector('#location-search-open-time-filter:checked') ? 1 : 0);
			var sundayIsChecked = (document.querySelector('#location-search-sunday-open-filter:checked')? 1 : 0);

			var filterAmt = filterAmtLocations + filterAmtVehicles + filterAmtCheckbox + sundayIsChecked;

			if (filterAmt > 0) {
				filterTextElDesktop.innerHTML = "Filter (" + filterAmt + ")";
				filterTextElMobile.innerHTML = "Filter (" + filterAmt + ")";
			} else {
				filterTextElDesktop.innerHTML = "Filter";
				filterTextElMobile.innerHTML = "Filter";
			}

			// isoTest.updateFilteredNumber();
		},
		updateForNewLocation : function () {
			isoTest.log("updateForNewLocation()");

			window.clearInterval(isoTest.counter);

			if (isoTest.filtersCheckedNumber != 0) {
				isoTest.filtersCheckedNumber = 0;
				document.querySelector('.location-type-filters-trigger__button').innerHTML = 'All Locations<i class="icon icon-nav-carrot-down"></i>';
			}

			document.querySelector('#location-search-sunday-open-filter').checked = false;

			var allchecked = document.querySelectorAll('.iso-location-filters-modal.iso-modal .checkbox__label-checkbox.checked');
			if (allchecked.length > 0) {
				for (var i = 0; i < allchecked.length; i++) {
					allchecked[i].classList.remove('checked');
				}
			}

			for (var key in isoTest.checkedFilters) {
				isoTest.checkedFilters[key] = "false";
			}

			isoTest.filtersCheckedNumber = 0;

			var checkedLocations = document.querySelectorAll('.checkbox__label-checkbox');

			for(var x = 0; x < checkedLocations.length; x++) {
				var checkedLocationID = checkedLocations[x].id;
				isoTest.checkedFilters[checkedLocationID] = 'false';
				isoTest.updatePage(checkedLocationID,'checked');
			}

			isoTest.updateOrder();

			var locationTypeFiltersTriggerBtn = document.querySelector('.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__button');

			locationTypeFiltersTriggerBtn.disabled = true;
			locationTypeFiltersTriggerBtn.classList.add('disabled');

			document.querySelector('.iso-location-chicklet-clear').remove();
			document.querySelector('.location-chicklet-clear').click();

			helpers.elementLoaded('.search-results-wrapper .search-results ul .location-result-item.active .location-result-item__cta', function() {
				locationTypeFiltersTriggerBtn.disabled = false;
				locationTypeFiltersTriggerBtn.classList.remove('disabled');
				isoTest.addAttributeToAllLocations();
				isoTest.addLocationClearIcon();
			});


			if (document.querySelector('#location-search-open-time-filter:checked')) {
				document.querySelector('.iso-filters-desktop-expand .iso-filter-text').innerHTML = "Filter (1)";
				document.querySelector('.iso-filters-mobile-expand .iso-filter-text').innerHTML = "Filter (1)";
				document.querySelector('.gi .location-search-filter__container-content-text.desktop.iso-filter-shown-text').classList.add('iso-hide');
			} else {
				document.querySelector('.location-search-filter__container .location-search-filter__container-content .iso-clear-btn').classList.add('iso-hide');
				document.querySelector('.gi .location-search-filter__container-content-text.desktop.iso-filter-shown-text').classList.add('iso-hide');
				document.querySelector('.iso-filters-desktop-expand .iso-filter-text').innerHTML = "Filter";
				document.querySelector('.iso-filters-mobile-expand .iso-filter-text').innerHTML = "Filter";
			}
		},
		updateFilterCaptionText : function() {
			isoTest.log("updateFilterCaptionText()");

			var filterCaptionDesktopText = document.querySelector('.location-search-filter__container .location-search-filter__container-content-text.desktop').innerHTML;
			var filterCaptionMobile = document.querySelector('.location-search-filter__container .location-search-filter__container-content-text.mobile');

			filterCaptionMobile.innerHTML = filterCaptionDesktopText;
		},
		updateFilteredNumber : function() {
			isoTest.log("updateFilteredNumber()");

			window.setTimeout(function(){
				document.querySelector('.iso-results-num').innerHTML = isoTest.locationsNumber + " RESULTS";
				document.querySelector('.search-results-count small').innerHTML = isoTest.locationsNumber + " RESULTS";
			}, 500);
		},
		modalOpen : function() {
			isoTest.log("modalOpen()");

			window.clearInterval(isoTest.counter);

			document.querySelector('.iso-modal.iso-location-filters-modal').classList.add('active');
			document.querySelector('html').classList.add('iso-modal-open');

      		var modalFocus = document.querySelector('.iso-modal.iso-location-filters-modal');
      		isoTest.keepFocus(modalFocus);

      		modalFocus.querySelector('.close-modal').focus();
		},
		destroyModal : function() {
			isoTest.log("destroyModal()");

      		document.querySelector('html').classList.remove('iso-modal-open');
      		var elModal = document.querySelector('.iso-modal.iso-location-filters-modal');
			elModal.classList.remove('active');

			isoTest.counter = window.setInterval(function(){isoTest.checkForFilters();},100);
    	},
    	keepFocus : function(context) {
    		isoTest.log("keepFocus()");

	    	var allTabbableElements = context.querySelectorAll(isoTest.tabbableElements),
	        	firstTabbableElement = allTabbableElements[0],
	          	lastTabbableElement = allTabbableElements[allTabbableElements.length - 1];

	      	var keyListener = function(e) {
	    		var keyCode = e.which || e.keyCode;

	    		e.preventDefault = e.preventDefault || function () {
	    			e.returnValue = false;
	    		};

	    		if (keyCode === 9) {
	          		if (e.target === lastTabbableElement && !e.shiftKey) {
	    				e.preventDefault();
	    				firstTabbableElement.focus();
	          		} else if (e.target === firstTabbableElement && e.shiftKey) {
	    				e.preventDefault();
	    				lastTabbableElement.focus();
	    			}
	    		}
	    	};
	    	context.addEventListener('keydown', keyListener, false);
	    },
		fireTag : function(element, value) {
			isoTest.log("fireTag()");

			var linkName = value ? value : element.innerText;
				linkName = isoTest.test ? isoTest.test + ' : ' + linkName : linkName;
			s.linkTrackVars = 'eVar20';
			s.eVar20 = linkName;
			s.tl(this, 'o', linkName);
		},
		fireTagApply : function(element, value, items) {
			isoTest.log("fireTagApply()");

			var linkName = value ? value : element.innerText;
				linkName = isoTest.test ? isoTest.test + ' : ' + linkName : linkName;
			var checkedName = items;
				checkedName = isoTest.test ? isoTest.test + ' : ' + checkedName : checkedName;
			s.linkTrackVars = 'eVar20,eVar89';
			s.eVar20 = linkName;
			s.eVar89 = checkedName;
			s.tl(this, 'o', linkName, checkedName);
		},
		log : function(obj){
			if(isoTest.debug === true){
				console.log(obj);
			}
		}
	}

	var helpers = {
		elementLoaded : function (ele, callback) {
			// isoTest.log('elementLoaded::  ' + ele + ' - Checking...');
			window.clearTimeout(isoTest.eleTimer);
			if (document.querySelectorAll(ele).length > 0) {
				if (typeof callback === 'function') {
					// isoTest.log('elementLoaded::  ' + ele + ' - Found!');
					callback();
				}
	        } else {
	            isoTest.eleTimer = window.setTimeout(function(){helpers.elementLoaded(ele, callback);}, 100);
	        }
		},
		getIndex : function(child){
		    var parent = child.parentNode;
		    var children = parent.children;
		    var i = children.length - 1;
		    for (; i >= 0; i--){
		        if (child == children[i]){
		            break;
		        }
		    }
		    return i;
		}
	}

	isoTest.init();
})();
</script>
