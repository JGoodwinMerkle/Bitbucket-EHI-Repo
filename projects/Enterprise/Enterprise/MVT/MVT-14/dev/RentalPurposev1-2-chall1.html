<style>
  .iso-modal-open { overflow: hidden;height: 100%; }
  .iso-modal strong { font-family: "DINRegular",Arial,sans-serif; }
  .iso-modal .modal-body h2:before {
      content: '* Required';
      position: absolute;
      bottom: 20px;
      right: 0;
      font-size: 15px;
      font-family: "DINLight",Arial,sans-serif;
      line-height: 1;
      color: #676767;
  }
  .fr_ca .iso-modal .modal-body h2:before {
    content: '* Required';
  }
  .iso-modal .modal-body { position: relative; }
  .iso-modal .modal-body h2 { position: relative; border-bottom: 3px solid #181918; margin-bottom: 17px; font-size: 26px; }
  .iso-modal.modal-container.active .modal-content h2 { padding-bottom: 12px; }
  .iso-modal .modal-body p { font-size: 15px; margin: 0 0 26px; }
  .iso-modal .modal-body p:last-of-type { line-height: 1; margin: 0 0 13px; }
  .iso-modal .modal-body label { font-family: "DINLight",Arial,sans-serif; font-size: 15px; padding: 0; margin: 0 0 6px; }
  .iso-modal .modal-body label:last-of-type { margin: 0; }
  * .iso-modal .modal-body :focus input { box-shadow: 0px 0px 5px 3px #169a5a; border-radius: 6px; }
  * .iso-modal .modal-body :active input { box-shadow: none; }
  .iso-modal .modal-body label input { margin-right: 6px; }
  .iso-modal .modal-body .btn-grp { overflow: hidden; }
  .iso-modal .modal-body .btn-grp .btn { float: right; margin: 0; padding: 10px 37px 7px; font-size: 15px; }
  .iso-modal .modal-body .btn-grp .btn.disabled { cursor: not-allowed; }
  </style>
  <script>
  (function() {
    'use strict'; 
    var isoTest = {
      debug : false,
      account : 'Enterprise',
      portfolio : 'Enterprise.com',
      test : "Rental Purpose (No jQuery)",
      cookieName : 'ehiRentalPurpose',
      creative : "Challenger 1",
      customMbox : 'ehiRentalPurposeClicks',
      storage : localStorage,
      lang : 'en',
      tld: 'com',
      tabbableElements : 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]',
      content : {
        com: {
          en : {
            modal : {
              heading : 'Why are you renting today?',
              copy : 'Please let us know why you are renting. <strong>Your answer will not affect your reservation</strong> in any way. We are only asking for this information from select customers in order to improve our website experience.',
              label : 'Rental Purpose *',
              choices : [
                { id : 'purposeLeisure', option : '<strong>Leisure</strong> travel or other <strong>occassional</strong> needs', value : 'Leisure' },
                { id : 'purposeBusiness', option : '<strong>Business</strong> travel', value : 'Business' },
                { id : 'purposeDamage', option : 'Vehicle damaged due to <strong>accident or storm</strong>', value : 'Damage' },
                { id : 'purposeService', option : 'Vehicle being serviced due to <strong>recall, breakdown or routine maintenance</strong>', value : 'Service' },
                { id : 'purposeNoAnswer', option : 'Prefer not to answer', value : 'NoAnswer' },
              ],
              buttonText : 'Continue'
            },
            error : {
              prefix : 'ERROR:',
              errorText : 'Please choose one of the following to continue'
            }
          },
          fr : {
            modal : {
              heading : 'Pour quelle raison louez-vous un véhicule aujourd\'hui?',
              copy : 'Dites-nous pourquoi vous avez besoin de cette location. Nous ne posons cette question à certains clients que dans le but d\'améliorer l\'efficacité de notre site Web, et votre réponse n\'aura aucun effet sur votre réservation.',
              label : 'Raison de la location *',
              choices : [
                { id : 'purposeLeisure', option : '<strong>Voyage d\'agrément</strong> ou autres nécessités <strong>occasionnelles</strong>', value : 'Leisure' },
                { id : 'purposeBusiness', option : 'Voyage <strong>d\'affaires</strong>', value : 'Business' },
                { id : 'purposeRepairSelf', option : 'Mon véhicule est au <strong>garage</strong>; c\'est <strong>moi</strong> qui défraie la location', value : 'RepairSelf' },
                { id : 'purposeRepairInsurance', option : 'Mon véhicule est au <strong>garage</strong>; c\'est <strong>mon assurance</strong> qui défraie la location', value : 'RepairInsurance' },
                { id : 'purposeNoAnswer', option : 'Je préfère ne pas répondre', value : 'NoAnswer' },
              ],
              buttonText : 'Continuer'
            },
            error : {
              prefix : 'ERROR:',
              errorText : 'Please choose one of the following to continue'
            }
          }
        },
        ca : {
          en : {
            modal : {
              heading : 'Why are you renting today?',
              copy : 'Please let us know why you are renting. <strong>Your answer will not affect your reservation</strong> in any way. We are only asking for this information from select customers in order to improve our website experience.',
              label : 'Rental Purpose *',
              choices : [
                { id : 'purposeLeisure', option : '<strong>Leisure</strong> travel or other <strong>occassional</strong> needs', value : 'Leisure' },
                { id : 'purposeBusiness', option : '<strong>Business</strong> travel', value : 'Business' },
                { id : 'purposeRepairSelf', option : 'Vehicle being <strong>repaired/serviced</strong>; rental costs paid by <strong>myself</strong>', value : 'RepairSelf' },
                { id : 'purposeRepairInsurance', option : 'Vehicle being <strong>repaired/serviced</strong>; rental costs paid by <strong>insurance</strong>', value : 'RepairInsurance' },
                { id : 'purposeNoAnswer', option : 'Prefer not to answer', value : 'NoAnswer' },
              ],
              buttonText : 'Continue'
            },
            error : {
              prefix : 'ERROR:',
              errorText : 'Please choose one of the following to continue'
            }
          },
          fr : {
            modal : {
              heading : 'Pour quelle raison louez-vous un véhicule aujourd\'hui?',
              copy : 'Dites-nous pourquoi vous avez besoin de cette location. Nous ne posons cette question à certains clients que dans le but d\'améliorer l\'efficacité de notre site Web, et votre réponse n\'aura aucun effet sur votre réservation.',
              label : 'Raison de la location *',
              choices : [
                { id : 'purposeLeisure', option : '<strong>Voyage d\'agrément</strong> ou autres nécessités <strong>occasionnelles</strong>', value : 'Leisure' },
                { id : 'purposeBusiness', option : 'Voyage <strong>d\'affaires</strong>', value : 'Business' },
                { id : 'purposeRepairSelf', option : 'Mon véhicule est au <strong>garage</strong>; c\'est <strong>moi</strong> qui défraie la location', value : 'RepairSelf' },
                { id : 'purposeRepairInsurance', option : 'Mon véhicule est au <strong>garage</strong>; c\'est <strong>mon assurance</strong> qui défraie la location', value : 'RepairInsurance' },
                { id : 'purposeNoAnswer', option : 'Je préfère ne pas répondre', value : 'NoAnswer' },
              ],
              buttonText : 'Continuer'
            },
            error : {
              prefix : 'ERROR:',
              errorText : 'Please choose one of the following to continue'
            }
          }
        }
      },
      templates : {
        modal : '<div class="iso-modal modal-container active" tabindex="0">\
          <div class="modal-content">\
            <div class="modal-header"></div>\
            <div class="modal-body">\
              <h2>{heading}</h2>\
              <p>{copy}</p>\
              <p><strong>{label}</strong></p>\
              <div class="iso-purpose-options">\
                <label for="{choices.0.id}" tabindex="0"><input type="radio" id="{choices.0.id}" name="purpose" value="{choices.0.value}" tabindex="-1" /><span>{choices.0.option}</span></label>\
                <label for="{choices.1.id}" tabindex="0"><input type="radio" id="{choices.1.id}" name="purpose" value="{choices.1.value}" tabindex="-1" /><span>{choices.1.option}</span></label>\
                <label for="{choices.2.id}" tabindex="0"><input type="radio" id="{choices.2.id}" name="purpose" value="{choices.2.value}" tabindex="-1" /><span>{choices.2.option}</span></label>\
                <label for="{choices.3.id}" tabindex="0"><input type="radio" id="{choices.3.id}" name="purpose" value="{choices.3.value}" tabindex="-1" /><span>{choices.3.option}</span></label>\
                <label for="{choices.4.id}" tabindex="0"><input type="radio" id="{choices.4.id}" name="purpose" value="{choices.4.value}" tabindex="-1" /><span>{choices.4.option}</span></label>\
              </div>\
              <div class="btn-grp">\
                <div class="btn disabled" tabindex="0">{buttonText}</div>\
              </div>\
            </div>\
          </div>\
        </div>',
        error : '<div class="error-container">\
          <div class="global-error">\
            <span class="error-prefix">{prefix}</span>\
            <span>{errorText}</span>\
          </div>\
        </div>'
      },
      clickTracking : [
        { element : '.iso-modal', evt : 'click', metric : 'OutsideModalClose', group : 'modal' },
        { element : '.iso-modal .modal-header', evt : 'click', metric : 'HeaderModalClose', group : 'element' }
      ],
      init : function() {
  
        isoTest.debug = Boolean(helpers.getQueryParam('debug'));
        
        if (_satellite && _satellite.setVar && typeof _satellite.setVar === 'function') {
          _satellite.setVar('TargetCampaign', isoTest.test);
          _satellite.setVar('TargetCreative', isoTest.creative);
          if (typeof window.isoSetTargetVars === 'function') {
            window.isoSetTargetVars();
          }
        }
  
        adobe.target.getOffer({
          "mbox": isoTest.customMbox,
          "success": function(offers) {
            adobe.target.applyOffer( { "mbox": isoTest.customMbox,"offer": offers } );
          },
          "error": function(status, error) {
  
          }
        });
      
        isoTest.log('Test Running...');
        isoTest.log(isoTest.account + ' - ' + isoTest.portfolio);
        isoTest.log(isoTest.test + ' - ' + isoTest.creative);
  
        isoTest.dependsLoaded(function() {
          isoTest.log('Test Ready!');	
          if (!isoTest.storage.purpose) {
            isoTest.chall();
          } 
        });
  
      },
      chall : function() {
        isoTest.storage.setItem('purpose','seen');
        isoTest.getTLD();
        isoTest.getLang();
        isoTest.waitForLocationLoad(function() {
          isoTest.addPurpose();
        });
        
      },
      waitForLocationLoad : function(callback) {
        if (window.location.hash === '#location') {
          var thresh = 1000;
          var count = 0;
          var interval = 100;
          var loaderLoop = function(){
            setTimeout(function(){
              if (document.querySelectorAll('.spinner-container').length === 0) {
                count += interval;
              } else {
                count = 0;
              }
              if (count >= thresh) {
                callback();
              } else {
                loaderLoop();
              }
            }, interval);
          }
          loaderLoop();
        } else {
          if (typeof callback === 'function') {
            callback();
          }
        }
      },
      getTLD : function() {
        if (window.location.hostname.indexOf('.ca') > -1) {
          isoTest.tld = 'ca';
        }
      },
      getLang : function() {
        if (window.location.href.indexOf('/fr/') > -1) {
          isoTest.lang = 'fr';
        }
      },
      addPurpose : function() {
        var modal = helpers.supplant(isoTest.templates.modal, isoTest.content[isoTest.tld][isoTest.lang].modal);
  
        document.querySelector('#ip-redirect').insertAdjacentHTML("afterend", modal);
  
        isoTest.shufflePurpose('.iso-purpose-options');
  
        document.querySelector('html').classList.add('iso-modal-open');
  
        isoTest.observeDOM(document.querySelector('html'), function() {
          if (document.querySelector('html').classList.contains('iso-modal-open')) {	
            document.querySelector('html').classList.remove('iso-modal-open');
          }
          if (document.querySelector('.iso-modal')) {
            var elModal = document.querySelector('.iso-modal');
            elModal.parentNode.removeChild(elModal);
          }
        });
  
        var modalFocus = document.querySelector('.iso-modal');
        isoTest.keepFocus(modalFocus);
  
        modalFocus.focus();
  
        
        // track purpose and destroy modal
        document.querySelector('.iso-modal .btn').addEventListener('click', function (e) {
          isoTest.submitPurpose(function() {
            isoTest.destroyModal();
          });
        }, false);
  
  
        document.addEventListener("keypress", function (e) {
          var keyCode = (e.keyCode ? e.keyCode : e.which);
          var continueBtn = document.querySelector('.iso-modal .btn');
  
          if (keyCode == '13') {
            if (e.target == continueBtn) {
              isoTest.submitPurpose(function() {
                isoTest.destroyModal();
              });
            }
          }
        }, false);
  
        // close modal from keyboard
        document.addEventListener("keydown", function (e) {
  
          var keyCode = (e.keyCode ? e.keyCode : e.which);
          isoTest.log(keyCode);
          isoTest.log(e);
          isoTest.log(e.target);
          isoTest.log(e.target.className.indexOf('disabled'));
    
          if (isoTest.keyboardClose(keyCode)) {
            if (document.querySelector('html').classList.contains('iso-modal-open')) {
              isoTest.log('Keyboard Esc Close');
              isoTest.destroyModal();
            }
          }
        }, false);
  
        // activate button
        var optionsButtons = document.querySelectorAll('.iso-purpose-options label');
        for (var i = 0; i < optionsButtons.length; i++) {
          optionsButtons[i].addEventListener('click', function (e) {
            if (document.querySelector('.iso-modal .btn').classList.contains('disabled')) {
              document.querySelector('.iso-modal .btn').classList.remove('disabled');
            }
          }, false);
        }
      },
      shufflePurpose : function(container) {
        var container = document.querySelector(container),
            temp = container.cloneNode(true),
            i = temp.children.length;
        while (i-- > 0)
          temp.appendChild(temp.children[Math.random() * i | 0]);
  
        container.parentNode.replaceChild(temp, container);
      },
      submitPurpose : function(callback) {
        var currentHash = _analytics.reservation.currentHash.split('#'),
            location = isoTest.titleCase(currentHash[currentHash.length - 1]),
            purpose = '';
  
          if (document.querySelector('.iso-purpose-options input:checked') != null) {
            purpose = document.querySelector('.iso-purpose-options input:checked').value;
  
            isoTest.log('Purpose:' + purpose);
      
            isoTest.setOmniture(purpose, location);
        
            callback();
          } else {
            isoTest.log('ErrorSubmission');
          }
        
      },
      destroyModal : function() {
        document.querySelector('html').classList.remove('iso-modal-open');
        var elModal = document.querySelector('.iso-modal');
        elModal.parentNode.removeChild(elModal);
      },
      observeDOM : (function() {
  
        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;
  
        return function(obj, callback) {
          if (MutationObserver) {
            var obs = new MutationObserver(function(mutations, observer) {
              var modalClass = mutations[0].target.classList.contains('modal-open');
    
              // if (mutations[0].attributeName === 'class' && modalClass) {
               if (mutations[0].attributeName === 'class') {
                callback();
              }
            });
            obs.observe(obj, { attributes : true, attributeOldvalue : true });
          }
        }
      })(),
      keepFocus : function(context) {
        var allTabbableElements = context.querySelectorAll(isoTest.tabbableElements),
            firstTabbableElement = allTabbableElements[0],
            lastTabbableElement = allTabbableElements[allTabbableElements.length - 1];
        var keyListener = function(e) {
          var keyCode = e.which || e.keyCode;
  
          e.preventDefault = e.preventDefault || function () {
            e.returnValue = false;
          };
          if (keyCode === 9) {
            if (e.target === lastTabbableElement && !e.shiftKey) {
              e.preventDefault();
              firstTabbableElement.focus();
            } else if (e.target === firstTabbableElement && e.shiftKey) {
              e.preventDefault();
              lastTabbableElement.focus();
            }
          }
        };
        context.addEventListener('keydown', keyListener, false);
      },
      keyboardClose : function(characterCode) {
        var isEsc = false;
        switch (characterCode) {
          case 27:
            isEsc = true;
            break;
          default:
            break;
        }
        return isEsc;
      },
      titleCase : function(str) {
        return str.replace(/\w\S*/g, function(txt) {
          return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
        });
      },
      setTargetCookie : function (test, creative) {
        if (test && creative) {
          _satellite.setCookie('tt_info', test + '|' + creative);
        }
      },
      setTrackingCookie : function(page) {
        _satellite.setCookies('tt_review', page);
      },
      setOmniture : function(value, location) { // value = NoAnswer, location = Cars
        var pageName = _analytics.pageInfo.pageName,
            linkName = 'RW:' + location + ':Purpose';
        s.linkTrackVars = 'eVar20,prop22,prop23,eVar55,eVar89';
        s.eVar20 = linkName;
        s.prop22 = linkName;
        s.prop23 = linkName + ':' + value; // RW:Cars:Purpose
        s.eVar55 = pageName + '#purposemodal'; // reservationpage#purposemodal
        s.eVar89 = 'Purpose:' + value; // Purpose:NoAnswer
        s.tl(this, 'o', linkName);
  
        return false;
      },
      elementLoaded : function (ele, callback) {
        isoTest.log('elementLoaded::  ' + ele + ' - Checking...');
        window.clearTimeout(isoTest.eleTimer);
        if (document.querySelectorAll(ele).length > 0) {
          if (typeof callback === 'function') {
            isoTest.log('elementLoaded::  ' + ele + ' - Found!');
            callback();
          }
            } else {
                isoTest.eleTimer = window.setTimeout(function(){isoTest.elementLoaded(ele, callback);}, 100);
            }
      },
      dependsLoaded : function (callback) {
        if (isoTest.debug === true) {
          console.log(isoTest.test + " - " + isoTest.creative + " - dependsLoaded - Start...");
        }
        window.clearTimeout(isoTest.timer);
        if (typeof _analytics === "object") {
          if (typeof callback === 'function') {
            if (isoTest.debug === true) {
              console.log(isoTest.test + " - " + isoTest.creative + " - dependsLoaded - Ready!");
            }
            callback();
          }
        } else {
          isoTest.timer = window.setTimeout(function() {
            isoTest.dependsLoaded(callback);
          }, 100);
        }
      },
      log : function(obj){
        if(isoTest.debug === true){
          console.log(obj);
        }
      }
      
    }
    var helpers = {
      getQueryParam: function(variable) {
          var query = window.location.search.substring(1);
          var vars = query.split('&');
          for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split('=');
            if (decodeURIComponent(pair[0]) == variable) {
              return decodeURIComponent(pair[1]);
            }
          }
        },
        supplant : function(str, o) {
        return str.replace(/{([^{}]*)}/g, function(a, b) { 
              var p = b.split(/\./),
                  c = o;
              for (var i = 0; i < p.length; i++) {
                if (c[p[i]] == null)
                  return a;
                c = c[p[i]];
              }
          return typeof c === 'string' || typeof c === 'number' ? c : a;
        });
      }
    }
  
    isoTest.init();
  })();
  </script>