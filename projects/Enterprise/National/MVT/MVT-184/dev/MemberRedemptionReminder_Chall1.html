<style>
	.iso-redeem-close {
		position: absolute;
		top: 0;
		right: 0;
		padding: 1em;
	}
	#iso-redeem-modal-container {
		text-align: center;
	}
	#iso-redeem-modal-container .modal__body {
		max-width: 480px;
    	margin: 0 auto;
    	padding: 3em;
	}
	#iso-redeem-modal-container h3 {
		font-size: 1.8em;
		font-weight: 700;
		margin-bottom: 0.8em;
	}
	#iso-redeem-modal-container h3 span {
		color: #00703c;
		font-family: "Playfair Display", Arial, Helvetica, sans-serif;
		font-size: 40px;
	}
	#iso-redeem-modal-container .btn {
		display: inline-block;
	    padding: 0.875rem 2rem;
	    width: auto;
	}
	.iso-hidden-modal, .iso-hide {
		display: none;
	}
	@media screen and (min-width: 40.0625em) {
		#iso-redeem-modal-container .ReactModal__Content {
			width: 32rem;
			margin-left: -16rem;
		}
	}
	
</style>
<script>
(function() {
	'use strict';
	var isoTest = {
		account : 'EHI',
		portfolio : 'National',
		test : 'Member Redemption Reminder',
		creative : 'Challenger 1',
		selector: '.rental-credits-card__count__number',
		modal: '<div class="ReactModal__Overlay ReactModal__Overlay--after-open modal__overlay modal__overlay--lightbox" aria-modal="true">\
					<div class="ReactModal__Content ReactModal__Content--after-open modal__content modal__content--lightbox zl-section--bgcolor-light " tabindex="-1" role="alertdialog" aria-label="redeem points modal">\
						<div class="modal__flex">\
						<button type="button" class="modal__btn-close icon icon--close iso-redeem-close" aria-label="Close the modal">\
							<span class="icon__text">Close the modal</span>\
						</button>\
							<div class="modal__body" tabindex="0">\
								<h3 class="iso-hide iso-redeem-day">YOU HAVE A <br><span>free day!</span></h3>\
								<h3 class="iso-hide iso-redeem-days">YOU HAVE <br><span class="iso-redeem-qty">X</span> <span>free days!</span></h3>\
								<p>To redeem now, select an amount under <strong>REWARD DAYS</strong> in the reservation form.</p>\
								<a class="btn" href="https://www.nationalcar.com/en/emerald-club/redeem-free-days.html">LEARN MORE</a>\
							</div>\
						</div>\
					</div>\
				</div>',
		init : function() {

			isoTest.debug = ${user.mvtDebug};
			
			if (_satellite && typeof _satellite.setVar === 'function' && typeof _satellite.track === 'function') {
				_satellite.setVar('TargetCampaign', isoTest.test);
				_satellite.setVar('TargetCreative', isoTest.creative);
				//_satellite.track('target_variables');
			}

			isoTest.log('Test Running...');
			isoTest.log(isoTest.account + ' - ' + isoTest.portfolio);
			isoTest.log(isoTest.test + ' - ' + isoTest.creative);

			helpers.elementLoaded(isoTest.selector, function() {
				isoTest.log('Test Ready!');
  				var daysEarned = parseInt(document.querySelector('.rental-credits-card__count__number').textContent,10);
				if (daysEarned > 0) {
  					isoTest.chall();
				}
			});
			
		},
		chall : function() {

			var redeemModalContainer = document.createElement('div');
			redeemModalContainer.classList.add('iso-ReactModalPortal','iso-visible-modal');
			redeemModalContainer.setAttribute("id", "iso-redeem-modal-container");
			redeemModalContainer.innerHTML = isoTest.modal;

			document.querySelector('body').appendChild(redeemModalContainer);
			document.querySelector('body').classList.add('ReactModal__Body--open');
			document.querySelector('#iso-redeem-modal-container .modal__btn-close').focus();

			var daysEarned = parseInt(document.querySelector('.rental-credits-card__count__number').textContent,10);
			document.querySelector('.iso-redeem-qty').innerText = daysEarned;

			if (daysEarned == 1) {
				document.querySelector('.iso-redeem-day').classList.remove('iso-hide');
			}
			if (daysEarned > 1) {
				document.querySelector('.iso-redeem-days').classList.remove('iso-hide');
			}

			isoTest.addEvents();

		},
		addEvents : function() {
			
			document.addEventListener('click', function (event) {
				if (event.target.matches('#iso-redeem-modal-container .ReactModal__Overlay') || event.target.matches('#iso-redeem-modal-container .modal__btn-close')) {
					document.querySelector('#iso-redeem-modal-container').classList.remove("iso-visible-modal");
					document.querySelector('#iso-redeem-modal-container').classList.add("iso-hidden-modal");
					document.querySelector('body').classList.remove('ReactModal__Body--open');
				}
				if (event.target.matches('#iso-redeem-modal-container .btn')) {
					isoTest.fireTag();
				}
			});

			document.addEventListener('keypress', function (event) {
			    var keycode = (event.keyCode ? event.keyCode : event.which);
	    		if (keycode == '13') {
	    			if (event.target.matches('.modal__btn-close')) {
	    				event.target.click();
					}
			    }
		    }, false);

		    document.addEventListener('keydown', function (event) {
		    	if (event.keyCode == 27 || event.key == "Esc" || event.key == "Escape") {
 					if (document.querySelector('#iso-redeem-modal-container.iso-visible-modal')) {
 						document.querySelector('#iso-redeem-modal-container').classList.remove("iso-visible-modal");
						document.querySelector('#iso-redeem-modal-container').classList.add("iso-hidden-modal");
						document.querySelector('body').classList.remove('ReactModal__Body--open');
 					} 
		   		}
	    	}, false);

		},
		fireTag : function(element, value) {
			var linkName = value ? value : element.innerText;
				linkName = isoTest.test ? isoTest.test + ' : ' + linkName : linkName;
			s.linkTrackVars = 'eVar20';
			s.eVar20 = linkName;
			s.tl(this, 'o', linkName);
		},
		log : function(obj){
			if(isoTest.debug === true){
				console.log(obj);
			}
		}

	}

	var helpers = {
		elementLoaded : function (ele, callback) {
			isoTest.log('elementLoaded::  ' + ele + ' - Checking...');
			window.clearTimeout(isoTest.eleTimer);
			if (document.querySelectorAll(ele).length > 0) {
				if (typeof callback === 'function') {
					isoTest.log('elementLoaded::  ' + ele + ' - Found!');
					callback();
				}
	        } else {
	            isoTest.eleTimer = window.setTimeout(function(){helpers.elementLoaded(ele, callback);}, 100);
	        }
		},
	}

	isoTest.init();
})();
</script>
