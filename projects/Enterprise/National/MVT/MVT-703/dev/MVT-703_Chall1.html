<style>
	.mvt-703-vehicle-zoom {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg width='14' height='14' viewBox='0 0 14 14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4.85613 9.7068C2.17831 9.7068 0 7.52952 0 4.85326C0 2.17702 2.17848 0 4.85613 0C7.53378 0 9.71255 2.17727 9.71255 4.85354C9.71255 7.52977 7.53398 9.7068 4.85613 9.7068ZM4.85613 1.25703C2.87196 1.25703 1.25778 2.87037 1.25778 4.85326C1.25778 6.83614 2.87207 8.44948 4.85613 8.44948C6.84019 8.44948 8.45449 6.83614 8.45449 4.85326C8.4546 2.87026 6.8403 1.25703 4.85613 1.25703Z' fill='%2300703C'/%3E%3Cpath d='M4.89996 2.79834V7.17203' stroke='%2300703C' stroke-miterlimit='10'/%3E%3Cpath d='M7.08811 4.98519H2.71182' stroke='%2300703C' stroke-miterlimit='10'/%3E%3Cpath d='M12.6782 13.9137L8.24745 9.48556C8.13228 9.37046 8.13228 9.182 8.24745 9.06678L9.06383 8.25087C9.179 8.13578 9.36757 8.13578 9.48286 8.25087L13.9136 12.679C14.0288 12.7941 14.0288 12.9826 13.9136 13.0978L13.0972 13.9137C12.9821 14.0288 12.7935 14.0288 12.6783 13.9136L12.6782 13.9137Z' fill='%2300703C'/%3E%3C/svg%3E");
        width: 14px;
        height: 14px; 
        background-size: cover;
        background-repeat: no-repeat; 
        align-self: flex-end;
        pointer-events: none;
        margin: auto 15% 0%;
        position: absolute;
        bottom: 8%;
    }
    .mvt-703-vehicle-image{
        display: flex;
        flex-direction: column;
        cursor: pointer;
        position: relative;
    }
    .mvt-703-vehicle-image.vehicle__image img {
        pointer-events: none;
    }
    .mvt-703-modal.modals_v2.mvt-703-hide {
        display: none;
    }
	.mvt-703-modal.modals_v2 .modal__body {
        display: flex;
        justify-content: center;
    }
    .mvt-703-modal.modals_v2 .modal__body img {
        width: 337px;
    }
    .mvt-703-modal.modals_v2 .modal__header .modal__btn-close:before {
        color: #b3d78b;
    }
    @media  screen and (min-width: 640px) {
        .mvt-703-close , .mvt-703-select {
            width: 216px;
        }
        .mvt-703-modal.modals_v2 .modal__footer{
            flex-direction: column;
        }
    }
    
    @media  screen and (min-width: 1280px) and (max-width: 1406px){ 
        .mvt-703-vehicle-zoom{
            margin: auto;
        }
        
    }
    @media  screen and (min-width: 912px) and (max-width: 1130px){ 
        .mvt-703-vehicle-zoom{
            margin: auto 2% -5%;
        }
        
    }
    @media  screen and (min-width: 640px) and (max-width: 869px){ 
        .mvt-703-vehicle-zoom{
            margin: auto -1% 0%;
        }
        
    }
    @media  screen and (max-width: 639px) { 
        .mvt-703-vehicle-zoom{
            margin: auto;
        }
        
    }
</style>
<script>
(function() {
	'use strict';
	var isoTest = {
		account : 'EHI',
		portfolio : 'National',
		test : 'MVT-703',
		creative : 'Challenger 1',
		selector : '.vehicle-select .vehicle-list',
        templateDefault: `<div class="mvt-703-vehicle-zoom"></div>`,
        modal: `<div class="mvt-703-modal modals_v2 mvt-703-hide">
                <div class="ReactModal__Overlay ReactModal__Overlay--after-open modal__overlay modal__overlay--lightbox">
                    <div class="ReactModal__Content ReactModal__Content--after-open modal__content modal__content--lightbox zl-section--bgcolor-light modal__content--scroll-visible" tabindex="-1" role="alertdialog" aria-label="" aria-modal="true">
                        <div class="modal__header">
                            <h2>Economy</h2>
                            <button type="button" class="modal__btn-close icon icon--close" aria-label="Close the modal" "><span class="icon__text">Close the modal</span></button>
                        </div>
                        <div class="modal__body"><img class="content" src="" alt="image"></div>
                        <div class="modal__footer cancel-and-apply-buttons">
                            <button class="btn btn--opaque btn--underline btn-secondary mvt-703-close" type="button">Close</button>
                            <button class="btn btn-primary mvt-703-select" type="button">Select</button>
                        </div>
                    </div>
                </div>
            </div>`,
        tabbableElements : 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]',
        vehicleData: {
            SCAR: {
                title: 'Standard',
                image:'https://assets.gcs.ehi.com/content/national/data/vehicle/bookingCountries/US/CARS/SCAR.doi.640.medium.imageSmallSideProfileNodePath.png/1544210775124.png',
            },
            FCAR: {
                title: 'Full Size',
                image:'https://assets.gcs.ehi.com/content/national/data/vehicle/bookingCountries/US/CARS/FCAR.doi.640.medium.imageSmallSideProfileNodePath.png/1618262777765.png',
            },
        },
       init : function() {

			isoTest.debug =true;
			
			if (_satellite && typeof _satellite.setVar === 'function' && typeof _satellite.track === 'function') {
				_satellite.setVar('TargetCampaign', isoTest.test);
				_satellite.setVar('TargetCreative', isoTest.creative);
			}

			isoTest.log('Test Running...');
			isoTest.log(isoTest.account + ' - ' + isoTest.portfolio);
			isoTest.log(isoTest.test + ' - ' + isoTest.creative);

			isoTest.observeEl(isoTest.selector, function(ele) {
				isoTest.log('Test Ready!');  
                
  				isoTest.chall(ele);
			});
			
		},
		chall: function(ele){
         console.log(ele);
         if(!document.querySelector('.mvt-703-modal.modals_v2')) {
            document.body.insertAdjacentHTML('beforeend',isoTest.modal);
         }
         isoTest.insertTemplate();
         isoTest.addEvents();
        },
        insertTemplate : function() {
            var vImage = document.querySelectorAll('.vehicle__image');
            vImage.forEach(image => {
                image.classList.add('mvt-703-vehicle-image');
                image.insertAdjacentHTML('beforeend',isoTest.templateDefault);
            });
           
        },
        updateModal:function (ele) {
            //console.log(ele.closest('.vehicle'));
            var vehicleMain = ele.closest('.vehicle');
            var vehicleReact = isoTest.getReactComponent(vehicleMain);
            var sippCode = vehicleReact.return.memoizedProps.vehicleCode;
            console.log(isoTest.vehicleData[sippCode].title);
            vehicleMain.classList.add('mvt-active');
            document.querySelector('.mvt-703-modal.modals_v2 .modal__header h2').innerText = isoTest.vehicleData[sippCode].title;
            document.querySelector('.mvt-703-modal.modals_v2 .modal__body img').setAttribute('src',isoTest.vehicleData[sippCode].image);
        },

        addEvents: function() {
            //keep focus 
            isoTest.keepFocus(document.querySelector('.mvt-703-modal.modals_v2'));
            //event for modal show
            isoTest.addEventOn('click','.mvt-703-vehicle-image',function(e) {
                if(document.querySelector('.vehicle.mvt-active')){
                    document.querySelector('.vehicle.mvt-active').classList.remove('mvt-active');
                }
                isoTest.updateModal(e.target);
               
             });
            // ONCE IMAGE LOADED
            document.querySelector('.mvt-703-modal.modals_v2 .modal__body img').addEventListener('load', function() {
                console.log('image loaded');
                this.closest('.mvt-703-modal.modals_v2').classList.add('mvt-image-loaded');
                if(document.querySelector('.mvt-703-modal.modals_v2').classList.contains('mvt-703-hide') && document.querySelector('.mvt-703-modal.modals_v2').classList.contains('mvt-image-loaded')) {
                    document.querySelector('.mvt-703-modal.modals_v2').classList.remove('mvt-703-hide');
                    document.body.classList.add('ReactModal__Body--open');
                }
            })
            //event for modal close on X click
            document.querySelector('.mvt-703-modal.modals_v2 .modal__btn-close.icon.icon--close').addEventListener('click',function(){
                if(!document.querySelector('.mvt-703-modal.modals_v2').classList.contains('mvt-703-hide')) {
                    document.querySelector('.mvt-703-modal.modals_v2').classList.add('mvt-703-hide');
                    document.querySelector('.mvt-703-modal.modals_v2').classList.remove('mvt-image-loaded');
                    document.body.classList.remove('ReactModal__Body--open');
                }
            });
         
             //event for modal close on closebtn click
             document.querySelector('.mvt-703-modal.modals_v2 .btn.btn--opaque.btn--underline.btn-secondary.mvt-703-close').addEventListener('click',function(){
                if(!document.querySelector('.mvt-703-modal.modals_v2').classList.contains('mvt-703-hide')) {
                    document.querySelector('.mvt-703-modal.modals_v2').classList.add('mvt-703-hide');
                    document.querySelector('.mvt-703-modal.modals_v2').classList.remove('mvt-image-loaded');
                    document.body.classList.remove('ReactModal__Body--open');
                }
            });
          
             // select event click 
             document.querySelector('.mvt-703-modal.modals_v2 .mvt-703-select').addEventListener('click',function(){
                document.querySelector('.vehicle-list > .vehicle.mvt-active .vehicle__cta > button').click();
                if(document.querySelector('.mvt-703-modal.modals_v2')){
                    document.querySelector('.mvt-703-modal.modals_v2').remove();
                }
                document.body.classList.remove('ReactModal__Body--open');
             });
          

        },
        keepFocus : function(context) {
      		var allTabbableElements = context.querySelectorAll(isoTest.tabbableElements),
         		firstTabbableElement = allTabbableElements[0],
          		lastTabbableElement = allTabbableElements[allTabbableElements.length - 1];

      		var keyListener = function(e) {
    			var keyCode = e.which || e.keyCode;

    			e.preventDefault = e.preventDefault || function () {
    				e.returnValue = false;
    			};
    			if (keyCode === 9) {
          			if (e.target === lastTabbableElement && !e.shiftKey) {
    					e.preventDefault();
    					firstTabbableElement.focus();
          			} else if (e.target === firstTabbableElement && e.shiftKey) {
    					e.preventDefault();
    					lastTabbableElement.focus();
    				}
    			}
    		};
    		context.addEventListener('keydown', keyListener, false);
    	},
		
		fireTag : function(element, value) {
			var linkName = value ? value : element.innerText;
				linkName = isoTest.test ? isoTest.test + ' : ' + linkName : linkName;
			s.linkTrackVars = 'eVar20';
			s.eVar20 = linkName;
			s.tl(this, 'o', linkName);
		},
		log : function(obj){
			if(isoTest.debug === true){
				console.log(obj);
			}
		},
        getReactComponent: function(node){
			    for(var key in node) {
					if(key.startsWith('__reactInternalInstance$') || key.startsWith('__reactFiber$')) {
						return node[key];
					}
					}
				return null;
		},
		observeEl: function (selector, callback) {
                  var processed = new Map, processElement = function (e) { processed && !processed.has(e) && (processed.set(e, !0), callback(e)) }, lookForSelector = function () { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : document; if (e.matches && e.matches(selector) && processElement(e)) return !0; if (e.querySelectorAll) { var r = e.querySelectorAll(selector); if (r.length) for (var o = 0; o < r.length; o++) { var t = r[o]; if (processElement(t)) return !0 } } }; lookForSelector(); var obs = new MutationObserver(function (e) { e.forEach(function (e) { if (e && e.addedNodes && e.addedNodes.length) for (var r = 0; r < e.addedNodes.length; r++) { var o = e.addedNodes[r].parentElement; if (o && lookForSelector(o)) return !0 } }) }); obs.observe(document, { attributes: !1, childList: !0, subtree: !0 });
        },
        //adding helper to add events to multiple elements
        addEventOn: function (eventType, selector, action) {
        document.addEventListener(eventType, function (e) {
          var target = e.target;
          if (target.matches(selector)) {
            action(e);
          } else {
            while (target && target.parentNode !== document) {
              target = target.parentNode;
              if (!target) {
                return;
              }
            }
          }
        });
      },

	};
	isoTest.init();
})();
</script>
