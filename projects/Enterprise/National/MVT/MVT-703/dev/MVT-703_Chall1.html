<style>
	.mvt-703-vehicle-zoom {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg width='14' height='14' viewBox='0 0 14 14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4.85613 9.7068C2.17831 9.7068 0 7.52952 0 4.85326C0 2.17702 2.17848 0 4.85613 0C7.53378 0 9.71255 2.17727 9.71255 4.85354C9.71255 7.52977 7.53398 9.7068 4.85613 9.7068ZM4.85613 1.25703C2.87196 1.25703 1.25778 2.87037 1.25778 4.85326C1.25778 6.83614 2.87207 8.44948 4.85613 8.44948C6.84019 8.44948 8.45449 6.83614 8.45449 4.85326C8.4546 2.87026 6.8403 1.25703 4.85613 1.25703Z' fill='%2300703C'/%3E%3Cpath d='M4.89996 2.79834V7.17203' stroke='%2300703C' stroke-miterlimit='10'/%3E%3Cpath d='M7.08811 4.98519H2.71182' stroke='%2300703C' stroke-miterlimit='10'/%3E%3Cpath d='M12.6782 13.9137L8.24745 9.48556C8.13228 9.37046 8.13228 9.182 8.24745 9.06678L9.06383 8.25087C9.179 8.13578 9.36757 8.13578 9.48286 8.25087L13.9136 12.679C14.0288 12.7941 14.0288 12.9826 13.9136 13.0978L13.0972 13.9137C12.9821 14.0288 12.7935 14.0288 12.6783 13.9136L12.6782 13.9137Z' fill='%2300703C'/%3E%3C/svg%3E");
        width: 14px;
        height: 14px; 
        background-size: cover;
        background-repeat: no-repeat; 
        align-self: flex-end;
        pointer-events: none;
    }
    .mvt-703-vehicle-image{
        display: flex;
        flex-direction: column;
        cursor: pointer;
    }
    .mvt-703-vehicle-image.vehicle__image img {
        pointer-events: none;
    }
    .mvt-703-modal.modals_v2.mvt-703-hide {
        display: none;
    }
	.mvt-703-modal.modals_v2 .modal__body {
        display: flex;
        justify-content: center;
    }
</style>
<script>
(function() {
	'use strict';
	var isoTest = {
		account : 'EHI',
		portfolio : 'National',
		test : 'MVT-703',
		creative : 'Challenger 1',
		selector : '.vehicle-select .vehicle-list > .vehicle',
        templateDefault: `<div class="mvt-703-vehicle-zoom"></div>`,
        modal: `<div class="mvt-703-modal modals_v2 mvt-703-hide">
                <div class="ReactModal__Overlay ReactModal__Overlay--after-open modal__overlay modal__overlay--lightbox">
                    <div class="ReactModal__Content ReactModal__Content--after-open modal__content modal__content--lightbox zl-section--bgcolor-light modal__content--scroll-visible" tabindex="-1" role="alertdialog" aria-label="" aria-modal="true">
                        <div class="modal__header">
                            <h2>Economy</h2>
                            <button type="button" class="modal__btn-close icon icon--close" aria-label="Close the modal" "><span class="icon__text">Close the modal</span></button>
                        </div>
                        <div class="modal__body"><img class="content" src="https://assets.gcs.ehi.com/content/national/data/vehicle/bookingCountries/US/CARS/ECAR.doi.352.medium.imageSmallSideProfileNodePath.png/1492780366644.png" alt=""></div>
                        <div class="modal__footer cancel-and-apply-buttons">
                            <button class="btn btn--opaque btn--underline btn-secondary mvt-703-close" type="button">Close</button>
                            <button class="btn btn-primary mvt-703-select" type="button">Select</button>
                        </div>
                    </div>
                </div>
            </div>`,
        vehicleData: {
            SCAR: {
                title: 'Standard',
                image:'https://assets.gcs.ehi.com/content/national/data/vehicle/bookingCountries/US/CARS/SCAR.doi.640.medium.imageSmallSideProfileNodePath.png/1544210775124.png',
            },
            FCAR: {
                title: 'Full Size',
                image:'https://assets.gcs.ehi.com/content/national/data/vehicle/bookingCountries/US/CARS/FCAR.doi.640.medium.imageSmallSideProfileNodePath.png/1618262777765.png',
            },
        },
       init : function() {

			isoTest.debug =true;
			
			if (_satellite && typeof _satellite.setVar === 'function' && typeof _satellite.track === 'function') {
				_satellite.setVar('TargetCampaign', isoTest.test);
				_satellite.setVar('TargetCreative', isoTest.creative);
			}

			isoTest.log('Test Running...');
			isoTest.log(isoTest.account + ' - ' + isoTest.portfolio);
			isoTest.log(isoTest.test + ' - ' + isoTest.creative);

			isoTest.observeEl(isoTest.selector, function(ele) {
				isoTest.log('Test Ready!');  
                
  				isoTest.chall(ele);
			});
			
		},
		chall: function(ele){
         console.log(ele);
         if(!document.querySelector('.mvt-703-modal.modals_v2')) {
            document.body.insertAdjacentHTML('beforeend',isoTest.modal);
         }
         var vImage = ele.querySelector('.vehicle__image');
         vImage.classList.add('mvt-703-vehicle-image');
         vImage.insertAdjacentHTML('beforeend',isoTest.templateDefault);
         isoTest.addEvents();
        },
        updateModal:function (ele) {
            console.log(ele.closest('.vehicle'));
            var vehicleReact = isoTest.getReactComponent(ele.closest('.vehicle'));
            var sippCode = vehicleReact.return.memoizedProps.vehicleCode;
            console.log(isoTest.vehicleData[sippCode].title);
            ele.classList.add('mvt-'+sippCode);
            document.querySelector('.mvt-703-modal.modals_v2 .modal__header h2').innerText = isoTest.vehicleData[sippCode].title;
            document.querySelector('.mvt-703-modal.modals_v2 .modal__body img').setAttribute('src',isoTest.vehicleData[sippCode].image);
        },
        addEvents: function() {
            //event for modal show
            isoTest.addEventOn('click','.mvt-703-vehicle-image',function(e) {
                isoTest.updateModal(e.target);
                if(document.querySelector('.mvt-703-modal.modals_v2').classList.contains('mvt-703-hide')) {
                    document.querySelector('.mvt-703-modal.modals_v2').classList.remove('mvt-703-hide');
                    document.body.classList.add('ReactModal__Body--open');
                }
             });
            //event for modal close on X click
            isoTest.addEventOn('click','.mvt-703-modal.modals_v2 .modal__btn-close.icon.icon--close',function() {
                if(!document.querySelector('.mvt-703-modal.modals_v2').classList.contains('mvt-703-hide')) {
                    document.querySelector('.mvt-703-modal.modals_v2').classList.add('mvt-703-hide');
                    document.body.classList.remove('ReactModal__Body--open');
                }
             });
             //event for modal close on closebtn click
             isoTest.addEventOn('click','.mvt-703-modal.modals_v2 .btn.btn--opaque.btn--underline.btn-secondary.mvt-703-close',function() {
                if(!document.querySelector('.mvt-703-modal.modals_v2').classList.contains('mvt-703-hide')) {
                    document.querySelector('.mvt-703-modal.modals_v2').classList.add('mvt-703-hide');
                    document.body.classList.remove('ReactModal__Body--open');
                }
             });

        },
		
		fireTag : function(element, value) {
			var linkName = value ? value : element.innerText;
				linkName = isoTest.test ? isoTest.test + ' : ' + linkName : linkName;
			s.linkTrackVars = 'eVar20';
			s.eVar20 = linkName;
			s.tl(this, 'o', linkName);
		},
		log : function(obj){
			if(isoTest.debug === true){
				console.log(obj);
			}
		},
        getReactComponent: function(node){
			    for(var key in node) {
					if(key.startsWith('__reactInternalInstance$') || key.startsWith('__reactFiber$')) {
						return node[key];
					}
					}
				return null;
		},
		observeEl: function (selector, callback) {
                  var processed = new Map, processElement = function (e) { processed && !processed.has(e) && (processed.set(e, !0), callback(e)) }, lookForSelector = function () { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : document; if (e.matches && e.matches(selector) && processElement(e)) return !0; if (e.querySelectorAll) { var r = e.querySelectorAll(selector); if (r.length) for (var o = 0; o < r.length; o++) { var t = r[o]; if (processElement(t)) return !0 } } }; lookForSelector(); var obs = new MutationObserver(function (e) { e.forEach(function (e) { if (e && e.addedNodes && e.addedNodes.length) for (var r = 0; r < e.addedNodes.length; r++) { var o = e.addedNodes[r].parentElement; if (o && lookForSelector(o)) return !0 } }) }); obs.observe(document, { attributes: !1, childList: !0, subtree: !0 });
        },
        //adding helper to add events to multiple elements
        addEventOn: function (eventType, selector, action) {
        document.addEventListener(eventType, function (e) {
          var target = e.target;
          if (target.matches(selector)) {
            action(e);
          } else {
            while (target && target.parentNode !== document) {
              target = target.parentNode;
              if (!target) {
                return;
              }
            }
          }
        });
      },

	};
	isoTest.init();
})();
</script>
