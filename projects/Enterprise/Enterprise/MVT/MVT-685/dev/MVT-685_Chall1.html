<style>
    /*styling for reswidget */
    .mvt-685-widget .inner-container.expanded{
        min-height: 0px;
    }
    .mvt-685-widget .booking-widget-expanded {
        display: none;
    }
    .mvt-685-widget .inner-container.expanded .pick-up-location .rs-input__field--hidden {
        display: block;
    }
    .mvt-685-widget .inner-container.expanded .pick-up-location .rs-input__fake-field {
        display: none;
    }
    .reservationWidget #reservationWidget.sticky-reservation-widget.mvt-685-widget {
        transition: none;
        visibility: hidden;
    }
  
    /*styling for banner */
	.mvt-685-banner {
        margin: 96px auto 83px auto;
        position: relative;
        width: 65.6875rem;
        display: flex;
        flex-direction: column;
    }
    .mvt-685-banner .mvt-header {
        align-self: center;
        font-weight: 800;
        font-size: 26px;
        line-height: 24px;
        text-align: center;
        letter-spacing: 0.2px;
    }
    .mvt-685-banner .mvt-container {
        display: flex;
        margin-top: 24px;
        border-bottom: 1px solid #c3c3c3;
        box-shadow: 0 1px 3px rgba(0,0,0,.2);
    }
    .mvt-685-banner .mvt-image {
        background-image: url('https://www.enterprise.com/content/dam/enterprise/marketing/mvt/mvt685_b_alldevices.jpg');
        height: 256px;
        background-size: cover;
        width: 325px;
     }
     .mvt-685-banner .mvt-content {
        background: #FFFFFF;
         width: 70%;
     }
     .mvt-685-banner .mvt-wrap {
        display: flex;
        flex-direction: row;
        padding: 33px 44px 26px 45px;
     }
     .mvt-685-banner .mvt-pickup {
        border: 1px solid #C3C3C3;
        border-radius: 0px;
        padding: 18px 34px;
        width: 50%;
        position: relative;
        border-right: 0;
     }
     .mvt-685-banner .mvt-pickup::after {
        background-color: #fff;
		background-image: url("data:image/svg+xml;charset=UTF-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3Csvg%0A%20%20%20xmlns%3Adc%3D%22http%3A//purl.org/dc/elements/1.1/%22%0A%20%20%20xmlns%3Acc%3D%22http%3A//creativecommons.org/ns%23%22%0A%20%20%20xmlns%3Ardf%3D%22http%3A//www.w3.org/1999/02/22-rdf-syntax-ns%23%22%0A%20%20%20xmlns%3Asvg%3D%22http%3A//www.w3.org/2000/svg%22%0A%20%20%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%0A%20%20%20viewBox%3D%220%200%2053.333332%2050.093334%22%0A%20%20%20height%3D%2250.093334%22%0A%20%20%20width%3D%2253.333332%22%0A%20%20%20xml%3Aspace%3D%22preserve%22%0A%20%20%20version%3D%221.1%22%0A%20%20%20id%3D%22svg2%22%3E%3Cmetadata%0A%20%20%20%20%20id%3D%22metadata8%22%3E%3Crdf%3ARDF%3E%3Ccc%3AWork%0A%20%20%20%20%20%20%20%20%20rdf%3Aabout%3D%22%22%3E%3Cdc%3Aformat%3Eimage/svg+xml%3C/dc%3Aformat%3E%3Cdc%3Atype%0A%20%20%20%20%20%20%20%20%20%20%20rdf%3Aresource%3D%22http%3A//purl.org/dc/dcmitype/StillImage%22%20/%3E%3C/cc%3AWork%3E%3C/rdf%3ARDF%3E%3C/metadata%3E%3Cdefs%0A%20%20%20%20%20id%3D%22defs6%22%3E%3CclipPath%0A%20%20%20%20%20%20%20id%3D%22clipPath18%22%0A%20%20%20%20%20%20%20clipPathUnits%3D%22userSpaceOnUse%22%3E%3Cpath%0A%20%20%20%20%20%20%20%20%20id%3D%22path20%22%0A%20%20%20%20%20%20%20%20%20d%3D%22m%200%2C0%20400%2C0%200%2C375.652%20-400%2C0%20L%200%2C0%20Z%22%20/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%0A%20%20%20%20%20transform%3D%22matrix%281.3333333%2C0%2C0%2C-1.3333333%2C0%2C50.093333%29%22%0A%20%20%20%20%20id%3D%22g10%22%3E%3Cg%0A%20%20%20%20%20%20%20transform%3D%22scale%280.1%29%22%0A%20%20%20%20%20%20%20id%3D%22g12%22%3E%3Cg%0A%20%20%20%20%20%20%20%20%20id%3D%22g14%22%3E%3Cg%0A%20%20%20%20%20%20%20%20%20%20%20clip-path%3D%22url%28%23clipPath18%29%22%0A%20%20%20%20%20%20%20%20%20%20%20id%3D%22g16%22%3E%3Cpath%0A%20%20%20%20%20%20%20%20%20%20%20%20%20id%3D%22path22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20style%3D%22fill%3A%23000000%3Bfill-opacity%3A1%3Bfill-rule%3Anonzero%3Bstroke%3Anone%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20d%3D%22m%20385.004%2C172.965%20-370.004%2C0%20c%20-8.28516%2C0%20-15%2C6.711%20-15%2C15%200%2C8.285%206.71484%2C15%2015%2C15%20l%20333.793%2C0%20-147.09%2C147.082%20c%20-5.859%2C5.855%20-5.859%2C15.359%200%2C21.211%205.859%2C5.859%2015.352%2C5.859%2021.211%2C0%20L%20395.609%2C198.57%20c%204.289%2C-4.289%205.579%2C-10.742%203.254%2C-16.347%20-2.324%2C-5.606%20-7.793%2C-9.258%20-13.859%2C-9.258%22%20/%3E%3Cpath%0A%20%20%20%20%20%20%20%20%20%20%20%20%20id%3D%22path24%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20style%3D%22fill%3A%23000000%3Bfill-opacity%3A1%3Bfill-rule%3Anonzero%3Bstroke%3Anone%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20d%3D%22m%20212.309%2C0%20c%20-3.836%2C0%20-7.676%2C1.46484%20-10.606%2C4.39453%20-5.859%2C5.85937%20-5.859%2C15.35157%200%2C21.21097%20L%20302.66%2C126.551%20c%205.86%2C5.859%2015.352%2C5.859%2021.211%2C0%205.859%2C-5.86%205.859%2C-15.352%200%2C-21.211%20L%20222.914%2C4.39453%20C%20219.984%2C1.46484%20216.148%2C0%20212.309%2C0%22%20/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A");
		background-position: center;
		background-repeat: no-repeat;
		background-size: 20px;
        content: '';
        height: 30px;
        padding: 10px;
        position: absolute;
        width: 30px;
        right: -25px;
        top: calc(50% - 25px);
     }
     .mvt-685-banner .mvt-pickup h5 , .mvt-685-banner .mvt-return h5{
        font-weight: 700;
        font-size: 16px;
        line-height: 21px;
        letter-spacing: 0.02em;
        color: #000000;
        margin-bottom: 0px;
     }
     .mvt-685-banner .mvt-pickup p ,  .mvt-685-banner .mvt-return p {
        font-weight: 400;
        font-size: 14px;
        line-height: 24px;
        letter-spacing: 0.01em;
        color: #000000;
        margin-bottom: 0px;
     }
     .mvt-685-banner .mvt-pickup p.mvt-pickup-date, .mvt-685-banner .mvt-pickup p.mvt-pickup-time ,  .mvt-685-banner .mvt-return p.mvt-return-date,.mvt-685-banner .mvt-return p.mvt-return-time {
        display: inline;
     }
     .mvt-685-banner .mvt-return {
        border: 1px solid #C3C3C3;
        border-radius: 0px;
        padding: 18px 34px;
        width: 50%;
     }
     .mvt-685-banner .cta-container.cta-container--align-center.rs-modal__buttons-container {
        justify-content: flex-end;
        margin-right: 44px;
     }
     @media (max-width:1070px)  {
        .mvt-685-banner {
            width: 100%;
        }
     }
     /*mobile and tablet design */
     @media (max-width:820px)  {
        .mvt-685-banner .mvt-container {
            border-bottom: none;
            box-shadow: none;
        }
        .mvt-685-banner .mvt-header {
            font-size: 22px;
            line-height: 28px;
        }
        .mvt-685-banner .mvt-image {
            display: none;
        }
        .mvt-685-banner .mvt-content {
            width: 100%;
            background: none;
        }
        .mvt-685-banner .mvt-wrap {
            flex-direction: column;
            background: #ffffff;
            padding: 0px;
        }
        .mvt-685-banner .mvt-pickup {
            border-right: 1px solid #c3c3c3;
            border-bottom: 0;
            width: 100%;
        }
        .mvt-685-banner .mvt-pickup::after {
            top: unset;
            bottom: -25px;
            left: calc(50% - 25px);
            transform: rotate(90deg);
        }
        .mvt-685-banner .mvt-return {
            width: 100%;
        }
        .mvt-685-banner .cta-container.cta-container--align-center.rs-modal__buttons-container {
            justify-content: center;
            margin-top: 26px;
        }
     }

</style>
<script>
(function() {
	'use strict';
	var isoTest = {
		account : 'EHI',
		portfolio : 'Enterprise',
		test : 'MVT-685',
		creative : 'Challenger 1',
		selector : '.container.responsivegrid.teaser-style-3.padding-top--medium.aem-GridColumn.aem-GridColumn--default--12',
        resWidget : '#reservationWidget',
        templateBanner: `<div class="mvt-685-banner">
                        <div class="mvt-header">Welcome back! Would you like to continue your reservation?</div>
                        <div class="mvt-container"><div class="mvt-image"></div>
                        <div class="mvt-content"> 
                            <div class="mvt-wrap">
                                <div class="mvt-pickup"><h5 class="mvt-content-title">PICK-UP</h5><p class="mvt-pickup-date">{pickupdate}</p><p class="mvt-pickup-time"> at {pickuptime}</p><p class="mvt-pickup-location">{pickuplocation}</p></div>
                                <div class="mvt-return"><h5 class="mvt-content-title">RETURN</h5><p class="mvt-return-date">{returndate}</p><p class="mvt-return-time"> at {returntime}</p><p class="mvt-return-location">{returnlocation}</p></div>
                            </div>
                            
                            <div class="cta-container cta-container--align-center rs-modal__buttons-container">
                                <button class="cta cta--secondary cta--large cta--noMargin btn-cancel" type="button">Discard</button>
                                <a class="cta cta--primary cta--large cta--noMargin btn-continue" type="button">Continue Reservation</a>
                            </div>
                        </div>
                        </div>
                     </div>`,
        deepLink : '/en/deeplink.html?v=2&pickUpLocation.searchCriteria={pickupID}&dropOffLocation.searchCriteria={returnID}&pickUpDateTime.date={pickupDateShort}&dropOffDateTime.date={returnDateShort}&pickUpDateTime.time={pickupTimeShort}&dropOffDateTime.time={returnTimeShort}',
  
       init : function() {

			isoTest.debug =true;
			
			if (_satellite && typeof _satellite.setVar === 'function' && typeof _satellite.track === 'function') {
				_satellite.setVar('TargetCampaign', isoTest.test);
				_satellite.setVar('TargetCreative', isoTest.creative);
			}

			isoTest.log('Test Running...');
			isoTest.log(isoTest.account + ' - ' + isoTest.portfolio);
			isoTest.log(isoTest.test + ' - ' + isoTest.creative);

			isoTest.observeEl(isoTest.selector, function(ele) {
				isoTest.log('Test Ready!');  
  				isoTest.chall();
			});
            isoTest.observeEl(isoTest.resWidget, function(ele) {
				isoTest.log('resWidget Ready!');  
  				isoTest.updateResWidget(ele);
			});
			
		},
        updateResWidget: function(ele) {
            console.log(ele);
            ele.classList.add('mvt-685-widget');
            isoTest.resWidgetFunction();
        },
        //Functionality to update res widget based on interaction 
        resWidgetFunction: function() {
            var eleUpdates = new MutationObserver(function(mutationsList) {
                mutationsList.forEach(function(mutation){
                    console.log(mutation)
                    //removed nodes
                    mutation.removedNodes.forEach(function (removedNode){
                        if(removedNode.classList != undefined) {
                            console.log(removedNode);
                            if(removedNode.classList.contains('rs-input__fake-field') ) {
                                console.log('removing class')
                            }
                        }
                    });
                    //added nodes 
                    mutation.addedNodes.forEach(function (addedNode){
                        if(addedNode.classList != undefined) {
                            console.log(addedNode);
                            if(addedNode.classList.contains('auto-complete') ) {
                                //actions
                                console.log('adding class');
                                if(document.querySelector('.mvt-685-widget')){
                                    document.querySelector('#reservationWidget.mvt-685-widget').classList.remove('mvt-685-widget');
                                    console.log('res class remove');
                                }
                            }
                        }
                    });

                });
            }) ;
            //after observe  add target element
            eleUpdates.observe(document.querySelector('form.location-input-container.location-search'), {subtree: true, childList: true});
        },
		chall: function(){
         //console.log(ele);
         // Set reservation info
			var pickupLocation = ReservationStateTree.get(['session','reservationSession','reservationsInitiateRequest','pickupLocation','name']);
			var returnLocation = ReservationStateTree.get(['session','reservationSession','reservationsInitiateRequest','returnLocation','name']);
			var pickupDate = new Date(ReservationStateTree.get(['session','reservationSession','reservationsInitiateRequest','pickup_time']));
			var returnDate = new Date(ReservationStateTree.get(['session','reservationSession','reservationsInitiateRequest','return_time']));

			var dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric',};

			var pickupDateFormatted = pickupDate.toLocaleDateString('en-US', dateOptions);
			var returnDateFormatted = returnDate.toLocaleDateString('en-US', dateOptions);
			var pickupTimeFormatted = pickupDate.toLocaleTimeString(undefined, { hour: '2-digit', minute: '2-digit' });
			var returnTimeFormatted = returnDate.toLocaleTimeString(undefined, { hour: '2-digit', minute: '2-digit' });

			// console.log("pickuplocation", pickupLocation, returnLocation, pickupDate, returnDate, dateOptions, pickupDateFormatted, returnDateFormatted, pickupTimeFormatted, returnTimeFormatted)

			var banner = helpers.supplant(isoTest.templateBanner, {
				'pickuplocation' : pickupLocation,
				'returnlocation' : returnLocation,
				'pickupdate' : pickupDateFormatted,
				'returndate' : returnDateFormatted,
				'pickuptime' : pickupTimeFormatted,
				'returntime' : returnTimeFormatted,
			});

			// Set deeplink
			var pickupID = ReservationStateTree.get(['session','reservationSession','reservationsInitiateRequest','pickup_location_id']);
			var returnID = ReservationStateTree.get(['session','reservationSession','reservationsInitiateRequest','return_location_id']);
			var pickupDateShort = pickupDate.toLocaleDateString();
			var returnDateShort = returnDate.toLocaleDateString();
			var pickupTimeShort = pickupDate.toLocaleTimeString('en-US', { hour12: false });
			var returnTimeShort = returnDate.toLocaleTimeString('en-US', { hour12: false });

			// console.log("pickup information ", pickupID, returnID, pickupDateShort, returnDateShort, pickupTimeShort, returnTimeShort);

			var deeplinkURL = helpers.supplant(isoTest.deepLink, {
				'pickupID' : pickupID,
				'returnID' : returnID,
				'pickupDateShort' : pickupDateShort,
				'returnDateShort' : returnDateShort,
				'pickupTimeShort' : pickupTimeShort,
				'returnTimeShort' : returnTimeShort,
			});
            if (!!pickupLocation && !!pickupDate && !!returnLocation && !!returnDate) {
                isoTest.insertTemplate(banner,deeplinkURL);
            }
         
         
        },
        insertTemplate : function(banner, link) {
            document.querySelector(isoTest.selector).insertAdjacentHTML('afterbegin', banner);
          // Update deeplink URL
            document.querySelector('.mvt-685-banner .btn-continue').setAttribute('href', link);
            sessionStorage.setItem('MVT-685-Banner-Seen', 'true');
            isoTest.addEvents();
        },
       

        addEvents: function() {
       
          // discard fucntionality 
          document.querySelector('.mvt-685-banner .btn-cancel').addEventListener('click',function(){
            document.querySelector('.mvt-685-banner').remove();
            if(document.querySelector('.mvt-685-widget')) {
                document.querySelector('#reservationWidget.mvt-685-widget').classList.remove('mvt-685-widget');
            }
          });

        },
       
		
		fireTag : function(element, value) {
			var linkName = value ? value : element.innerText;
				linkName = isoTest.test ? isoTest.test + ' : ' + linkName : linkName;
			s.linkTrackVars = 'eVar20';
			s.eVar20 = linkName;
			s.tl(this, 'o', linkName);
		},
		log : function(obj){
			if(isoTest.debug === true){
				console.log(obj);
			}
		},
       
		observeEl: function (selector, callback) {
                  var processed = new Map, processElement = function (e) { processed && !processed.has(e) && (processed.set(e, !0), callback(e)) }, lookForSelector = function () { var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : document; if (e.matches && e.matches(selector) && processElement(e)) return !0; if (e.querySelectorAll) { var r = e.querySelectorAll(selector); if (r.length) for (var o = 0; o < r.length; o++) { var t = r[o]; if (processElement(t)) return !0 } } }; lookForSelector(); var obs = new MutationObserver(function (e) { e.forEach(function (e) { if (e && e.addedNodes && e.addedNodes.length) for (var r = 0; r < e.addedNodes.length; r++) { var o = e.addedNodes[r].parentElement; if (o && lookForSelector(o)) return !0 } }) }); obs.observe(document, { attributes: !1, childList: !0, subtree: !0 });
        },
        
	};
    var helpers = {
		elementLoaded : function (ele, callback) {
			isoTest.log('elementLoaded::  ' + ele + ' - Checking...');
			window.clearTimeout(isoTest.eleTimer);
			if (document.querySelectorAll(ele).length > 0) {
				if (typeof callback === 'function') {
					isoTest.log('elementLoaded::  ' + ele + ' - Found!');
					callback();
				}
	        } else {
	            isoTest.eleTimer = window.setTimeout(function(){helpers.elementLoaded(ele, callback);}, 100);
	        }
		},
		dependsLoadedCount : 0,
		dependsLoaded : function (callback) {
			window.clearTimeout(isoTest.timer);
			//Check for reservation info in data object specified number of times
			if (helpers.dependsLoadedCount < 50) {
				if (typeof ReservationStateTree !== 'undefined' && typeof ReservationStateTree.get(['session', 'reservationSession', 'reservationsInitiateRequest']) !== 'undefined' && typeof ReservationStateTree.get(['session', 'reservationSession', 'reservationsInitiateRequest','pickupLocation','name']) !== 'undefined') {
					if (typeof callback === "function") {
						callback();
					}
				} else {
					isoTest.timer = window.setTimeout(function() {
						helpers.dependsLoadedCount++;
						helpers.dependsLoaded(callback);
					}, 100);
				}
			}
		},
		supplant : function(str, o) {
			return str.replace(/{([^{}]*)}/g, function(a, b) {
		        var p = b.split(/\./),
		            c = o;
		        for (var i = 0; i < p.length; i++) {
		          if (c[p[i]] == null)
		            return a;
		          c = c[p[i]];
		        }
				return typeof c === 'string' || typeof c === 'number' ? c : a;
			});
		}
	};
    if (sessionStorage.getItem('MVT-685-Banner-Seen') === null){
        helpers.dependsLoaded(function(){
		isoTest.init();
	    });
    } else {
       console.log('banner already seen in this visit');
   }
	
})();
</script>