<style>
.iso-modal-open {
	height: 100%;
	overflow: hidden;
}

.iso-modal.iso-location-filters-modal {
	display: none;
}

.iso-modal.iso-location-filters-modal.active {
	display: block;
}

.iso-modal.iso-location-filters-modal .location-search-filters-modal__description {
	font-size: 14px;
  font-style: normal;
  font-weight: 400;
  margin-bottom: 18px;
}

.iso-modal.iso-location-filters-modal .ReactModal__Content--after-open.default-modal .modal-content .checkbox__label-checkbox {
	height: 24px;
	width: 24px;
}

.iso-modal.iso-location-filters-modal .ReactModal__Content--after-open.default-modal .modal-content .location-search-filters-modal__location-search-list li {
	padding-bottom: 16px;
}

.iso-modal.iso-location-filters-modal .ReactModal__Content--after-open.default-modal .modal-content .checkbox__label  {
	position: relative;
}

.iso-modal.iso-location-filters-modal .checkbox__label .checkbox__text .icon {
	display: inline-block;
	margin-left: 8px;
	position: absolute;
}

.iso-modal.iso-location-filters-modal .location-search-filters-modal__header {
	position: relative;
}

.iso-modal.iso-location-filters-modal .location-search-filters-modal__clear-all.btn {
	background:	transparent;
	color: #169a5a;
	font-size: .875rem;
	font-style: normal;
	font-weight: 700;
  padding: .25rem;
  position: absolute;
  right: -.25rem;
  top: .375rem;
  text-decoration: underline;
  text-transform: uppercase;
}

.iso-location-filters-modal.iso-modal .iso-modal-apply {
	float: right;
}

.iso-location-filters-modal.iso-modal .iso-modal-cancel {
	background-color: rgba(107, 107, 107, 1);
	border-color: rgba(107, 107, 107, 1) !important;
}

.iso-location-filters-modal.iso-modal .iso-modal-cancel:hover {
	background-color: rgba(54, 54, 54, 1);
	border-color: rgba(54, 54, 54, 1) !important;
}

#location .location-search .location-chicklet .location-chicklet-clear {
	display: none;
}

#location .location-search .location-chicklet .iso-location-chicklet-clear {
	background: #e6e6e6;
	cursor: pointer;
  display: table-cell;
  font-size: 1.1875rem;
  line-height: 1.1875rem;
  margin: 0 0;
  padding: 0.7em;
  vertical-align: middle;
}

#location .location-search .location-chicklet .iso-location-chicklet-clear .iso-icon-location-close {
	background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiMyMDlENUEiIGQ9Ik0zMiAzLjM2MkwyOC43NS4xMTIgMTYuMTk3IDEyLjY2OCAzLjY0Mi4xMTNsLTMuMjUgMy4yNSAxMi41NTUgMTIuNTU0TC4zOTMgMjguNDdsMy4yNSAzLjI1IDEyLjU1My0xMi41NTRMMjguNzUgMzEuNzIgMzIgMjguNDcgMTkuNDQ2IDE1LjkxOCIvPjwvc3ZnPg==');
	background-repeat: no-repeat;
	background-size: 100%;
	display: block;
	height: 16px;
	margin: 6px;
  width: 13px;
}

.location-search-filter__container  .location-search-filter__container-content {
	width: 100%;
}

.location-search-filter__container .location-search-filter__container-content-header {
	color: #181918;
  display: inline-block;
  position: relative;
  top: -2px;
}

.location-search-filter__container .location-search-filter__container-content-header .location-search-filter__clear-all {
	margin-bottom: -10px;
	margin-left: 0;
  margin-top: -1px;
  position: absolute;
  white-space: nowrap;
}

.location-search-filter__container .location-search-filter__vehicle-filter {
	display: inline-block;
	margin-left: 66px;
}

.location-search-filter__container .location-search-filter__vehicle-filter .vehicle-filters-trigger__label-text {
	font-weight: 600;
}

.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label,
.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label #location-search-open-time-filter,
.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label .form-checkbox__text {
	display: inline-block;
}

.location-search-filter__container  .location-search-filter__container-content-text {
	margin-bottom: 0;
  margin-top: 15px;
}

.location-search-filter__container .location-search-filter__location-type-filter {
	display: inline-block;
  margin-left: 30px;
  min-width: 12.5rem;
}


.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__label {
	margin-top: 0;
	padding-bottom: 0;
}


.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__label .location-type-filters-trigger__label-text {
	display: inline-block;
	font-size: .9375rem;
	font-style: normal;
	font-weight: 600;
  text-transform: uppercase;
}


.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__button {
  font-style: normal;
  font-weight: 600;
  height: 3.125rem;
  margin-top: .1875rem;
  position: relative;
}

.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__button.disabled {
	background-color: #f3f3f3;
	color: #656565;
  cursor: not-allowed;
  font-style: normal;
	font-weight: 300;
}

.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__button.btn .icon {
	display: block;
	height: .75rem;
	position: absolute;
	right: .375rem;
  top: 50%;
  transform: translateY(-50%) rotate(-90deg);
  width: .75rem;
}

.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__button.disabled .icon {
	display: none;

}

.location-search-filter__container .location-search-filter__container-content-text.desktop {
	display: block;
}

.location-search-filter__container .location-search-filter__container-content-text.mobile {
	display: none;
}

#location .search-results-wrapper .search-results ul .location-result-item.active[data-active="active"] {
	display: block;
}

#location .search-results-wrapper .search-results ul .location-result-item[data-active="hide"] {
	display: none;
}

.location-search-filter__mobile-header span {
	color: white;
}

.location-search-filter__mobile-header .iso-results-num {
	color: #181918;
	position: absolute;
}

@media (max-width: 900px) and (min-width: 769px) {
	.location-search-filter__container {
		padding: 1.5625rem .625rem 1.25rem;
	}

	.location-search-filter__container .location-search-filter__container-content {
		padding-left: 10px;
	}
}


@media (max-width: 820px) and (min-width: 769px) {
	.location-search-filter__container .location-search-filter__vehicle-filter {
		margin-left: 45px;
	}

	.location-search-filter__container .location-search-filter__location-type-filter {
		margin-left: 20px;
	}

	.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label {
		margin-left: 1.5rem;
	}
}

@media (max-width: 768px){
	.location-search-filter__container .location-search-filter__container-content-header {
		display: flex;
    font-size: 26px;
    position: initial;
    top: auto;
	}

	.location-search-filter__container .location-search-filter__container-content-header .location-search-filter__clear-all {
    margin-bottom: auto;
    margin-left: .625rem;
    margin-top: auto;
    position: initial;
	}

	.location-search-filter__container .vehicle-filters-trigger.location-search-filter__vehicle-filter {
		display: block;
		margin: 0 0 1.5625rem;
	}

	.location-search-filter__container .location-type-filters-trigger.location-search-filter__location-type-filter {
		display: block;
    margin: 0 0 1.5625rem;
    width: 12.5rem;
    min-width: 12.5rem;
	}

	.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label {
		display: block;
	}

	.location-search-filter__container .location-search-filter__container-content-text.desktop {
		display: none;
	}

	.location-search-filter__container .location-search-filter__container-content-text.mobile {
		display: block;
		margin-bottom: 1.25rem;
		margin-top: 0;
	}
}
</style>
<script>
(function() {
	'use strict';
	var isoTest = {
		account : 'Enterprise',
		portfolio : 'Enterprise.com',
		test : 'Location Results Advanced Filter',
		creative : 'Challenger 1',
		selector: '.location-search-filter__container .location-search-filter__container-content',
		mapSelector: 'ENT-mappin-single-number-enterprise@2x',
		selectorLocations: '#location .search-results-wrapper .search-results ul .location-result-item.active',
		mapChangeSelector: '[aria-live=off]',
		content: '<div class="location-type-filters-trigger location-search-filter__location-type-filter">\
								<label class="location-type-filters-trigger__label" for="location-type-filters-trigger">\
									<span class="location-type-filters-trigger__label-text">LOCATION TYPE</span>\
								</label>\
								<button class="btn location-type-filters-trigger__button btn-input" tabindex="0" type="button" role="button" name="location-type-filters-trigger">All Locations<i class="icon icon-nav-carrot-down"></i></button>\
							</div>',
		modal: '<div class="iso-location-filters-modal iso-modal" >\
							<div class="ReactModal__Overlay ReactModal__Overlay--after-open modal-overlay fixed-overlay" aria-modal="true">\
								<div class="ReactModal__Content ReactModal__Content--after-open default-modal fixed-scroll-modal" tabindex="-1" role="dialog" aria-describedby="modal-context">\
									<div class="modal-inner">\
										<div class="modal-header">\
											<button class="close-modal" aria-label="Close" role="button" type="button"><i class="icon icon-close-x-white" aria-hidden="true">X</i></button>\
										</div>\
										<div class="modal-content cf">\
											<div class="location-search-filters-modal" id="modal-context">\
												<div class="location-search-filters-modal__header">\
													<h2 class="location-search-filters-modal__title">Location Type</h2>\
													<button class="btn location-search-filters-modal__clear-all iso-clear-location-filter" tabindex="0" type="button" role="button">Clear All</button>\
												</div>\
												<p class="location-search-filters-modal__description">Select the location type(s) you want to search by.</p>\
												<div class="location-search-filters-modal__location-search-list">\
													<ul>\
														<li>\
															<label class="checkbox__label " tabindex="0" id="checkbox_location_1" aria-checked="false" role="checkbox">\
																<span class="checkbox__label-checkbox" id="airport">\
																	<input class="location-type-checkbox" type="checkbox" name="location-search" value="Airport Locations">\
																	<i class="icon icon-check-green"></i>\
																</span>\
																<span class="checkbox__text">Airport Locations<i class="icon location-type-icon icon-location-airport" aria-label="Airport"></i></span>\
															</label>\
														</li>\
														<li>\
															<label class="checkbox__label " tabindex="0" id="checkbox_location_2" aria-checked="false" role="checkbox">\
																<span class="checkbox__label-checkbox" id="city">\
																	<input class="location-type-checkbox" type="checkbox" name="location-search" value="City Locations">\
																	<i class="icon icon-check-green"></i>\
																</span>\
																<span class="checkbox__text">City Locations<i class="icon location-type-icon icon-location-city" aria-label="City"></i></span>\
															</label>\
														</li>\
														<li>\
															<label class="checkbox__label" tabindex="0" id="checkbox_location_3" aria-checked="false" role="checkbox">\
																<span class="checkbox__label-checkbox" id="exotics">\
																	<input class="location-type-checkbox" type="checkbox" name="location-search" value="Exotics Locations">\
																	<i class="icon icon-check-green"></i>\
																</span>\
																<span class="checkbox__text">Exotics Locations<i class="icon location-type-icon icon-icon-exotics" aria-label="Exotics"></i></span>\
															</label>\
														</li>\
														<li>\
															<label class="checkbox__label " tabindex="0" id="checkbox_location_4" aria-checked="false" role="checkbox">\
																<span class="checkbox__label-checkbox"  id="port_of_call">\
																	<input class="location-type-checkbox" type="checkbox" name="location-search" value="Port Locations">\
																	<i class="icon icon-check-green"></i>\
																</span>\
																<span class="checkbox__text">Port Locations<i class="icon location-type-icon icon-location-port_of_call" aria-label="Port of Call"></i></span>\
															</label>\
														</li>\
														<li>\
															<label class="checkbox__label " tabindex="0" id="checkbox_location_5" aria-checked="false" role="checkbox">\
																<span class="checkbox__label-checkbox" id="rail">\
																	<input class="location-type-checkbox" type="checkbox" name="location-search" value="Train Station Locations">\
																	<i class="icon icon-check-green"></i>\
																</span>\
																<span class="checkbox__text">Train Station Locations<i class="icon location-type-icon icon-location-rail" aria-label="Rail"></i></span>\
															</label>\
														</li>\
													</ul>\
												</div>\
											</div>\
											<div class="modal-buttons-container ">\
												<button class="btn modal-button iso-modal-apply" type="button" role="button">Apply</button>\
												<button class="btn modal-button iso-modal-cancel" type="button" role="button">Cancel</button>\
											</div>\
										</div>\
								  </div>\
								</div>\
							</div>\
						</div>',
		noMatches: "<li class='location-result-item location-result-item--no-result active location-result-item--filter-applied iso-no-active-items' data-active='inactive'>\
									<div class='location-result-item__content-container'>\
										<p class='location-result-item__content-container-text'><span>Sorry, we couldn't find any locations matching your search criteria.  Please adjust filters.</span></p>\
									</div>\
								</li>",
		clearBtn : '<button class="btn location-search-filter__clear-all btn-unstyled" tabindex="0" type="button" role="button">Clear All</button>',
		tabbableElements : 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]',
		checkedFilters : {
			airport : 'false',
			city : 'false',
			exotics : 'false',
			port_of_call : 'false',
			rail : 'false'
		},
		counter : '',
		locationsNumber : '',
		filtersCheckedNumber : '0',
		init : function() {

			isoTest.debug = ${user.mvtDebug};

			if (_satellite && typeof _satellite.setVar === 'function' && typeof _satellite.track === 'function') {
				_satellite.setVar('TargetCampaign', isoTest.test);
				_satellite.setVar('TargetCreative', isoTest.creative);
				//_satellite.track('target_variables');
			}

			isoTest.log('Test Running...');
			isoTest.log(isoTest.account + ' - ' + isoTest.portfolio);
			isoTest.log(isoTest.test + ' - ' + isoTest.creative);

			helpers.elementLoaded(isoTest.selector, function() {
				isoTest.log('Test Ready!');
  			isoTest.chall();
			});

		window.addEventListener('hashchange', isoTest.viewChange, false);

		},
		viewChange : function(){
			if(/location/.test(location.hash)){
				helpers.elementLoaded(isoTest.selector, function() {
					isoTest.chall();
				});
			} else {
				if (document.querySelector('.iso-location-filters-modal.iso-modal') != null) {
					window.clearInterval(isoTest.counter);
					document.querySelector('.iso-location-filters-modal.iso-modal').remove();
				}
			}
		},
		chall : function() {
			isoTest.log('chall()');

			isoTest.addLocationFilter();
			isoTest.addFilterModal();
			isoTest.addEvents();
			isoTest.addLocationClearIcon();
			isoTest.addAttributeToAllLocations();
		},
		addLocationFilter : function() {
			isoTest.log('addLocationFilter()');
			var vehicleFilterHeader = document.querySelector('.location-search-filter__container .location-search-filter__container-content-header');

			var vehicleTypeFilter = document.querySelector('.location-search-filter__container .location-search-filter__vehicle-filter');

			var openCheckbox = document.querySelector('.location-search-filter__container .location-search-filter__container-filter.form-checkbox__label');

			vehicleFilterHeader.after(vehicleTypeFilter);

			vehicleTypeFilter.after(openCheckbox);

			if (document.querySelector('.location-search-filter__location-type-filter') == null) {
				vehicleTypeFilter.insertAdjacentHTML('afterend', isoTest.content);
			}

			var filterCaption = document.querySelector('.location-search-filter__container .location-search-filter__container-content-text');
			filterCaption.classList.add('desktop');

			var cln = filterCaption.cloneNode(true);
			cln.classList.add('mobile');
			cln.classList.remove('desktop');

			if (document.querySelector('.location-search-filter__container .location-search-filter__container-content-text.mobile') == null) {
				vehicleFilterHeader.after(cln);
			}
		},
		addFilterModal : function() {
			isoTest.log('addFilterModal()');
			if (document.querySelector('.iso-location-filters-modal.iso-modal') == null) {
				document.querySelector('#ip-redirect').insertAdjacentHTML("afterend", isoTest.modal);
			}
		},
		addAttributeToAllLocations : function() {
			isoTest.log('addAttributeToAllLocations()');
			helpers.elementLoaded(isoTest.selectorLocations, function() {
				var allLocations = document.querySelectorAll('#location .search-results-wrapper .search-results ul .location-result-item.active');
				for(var i = 0; i < allLocations.length; i++) {
					allLocations[i].setAttribute('data-active', 'active');
				}

				isoTest.locationsNumber = document.querySelectorAll('#location .search-results-wrapper .search-results ul .location-result-item[data-active="active"]').length;

				helpers.elementLoaded('.location-search-filter__mobile-header span', function() {
					if (document.querySelector('iso-results-num') == null) {
						document.querySelector('.location-search-filter__mobile-header span').insertAdjacentHTML('beforebegin','<span class="iso-results-num">'+isoTest.locationsNumber+' Results</span>');
					} else {
						document.querySelector('.iso-results-num').innerHTML = isoTest.locationsNumber + " Results";
					}
				});
			});
		},
		addLocationClearIcon : function() {
			isoTest.log('addLocationClearIcon()');

			helpers.elementLoaded('.location-chicklet-clear', function() {
				if (document.querySelector('.iso-location-chicklet-clear') == null) {
					document.querySelector('#location .location-chicklet-clear').insertAdjacentHTML('beforebegin','<div class="iso-location-chicklet-clear" tabindex="0" role="button"><i class="iso-icon-location-close"></i></div>');
				}
			});
		},
		checkForFilters : function() {
			isoTest.log("checkForFilters()");

			var checkedLocations = document.querySelectorAll('.checkbox__label-checkbox');

			if (document.querySelectorAll('.checkbox__label-checkbox.checked').length > 0) {
				var checkedLength = document.querySelectorAll('.checkbox__label-checkbox.checked').length;

				if (isoTest.filtersCheckedNumber != checkedLength) {
					isoTest.filtersCheckedNumber = checkedLength;
					document.querySelector('.location-type-filters-trigger__button').innerHTML = 'Locations ('+checkedLength+')<i class="icon icon-nav-carrot-down"></i>';
				}

				for(var i = 0; i < checkedLocations.length; i++) {
					var checkedLocationID = checkedLocations[i].id;

					if (!checkedLocations[i].classList.contains('checked')) {
						isoTest.checkedFilters[checkedLocationID] = 'false';
						isoTest.updatePage(checkedLocationID, 'unchecked');
					} else {
						isoTest.checkedFilters[checkedLocationID] = 'true';
						isoTest.updatePage(checkedLocationID,'checked');
					}
				}
			} else {
				if (isoTest.filtersCheckedNumber != 0) {
					isoTest.filtersCheckedNumber = 0;
					document.querySelector('.location-type-filters-trigger__button').innerHTML = 'All Locations<i class="icon icon-nav-carrot-down"></i>';
				}

				for(var i = 0; i < checkedLocations.length; i++) {
					var checkedLocationID = checkedLocations[i].id;
					isoTest.checkedFilters[checkedLocationID] = 'false';
					isoTest.updatePage(checkedLocationID,'checked');
				}

				window.clearInterval(isoTest.counter);
			}

			isoTest.updateClearBtn();
			isoTest.updateOrder();
		},
		updateClearBtn: function(){
			isoTest.log("updateClearBtn()");
			var filterHeader = document.querySelector('.location-search-filter__container-content-header');
			var vehicleTypeFilter = document.querySelector('.vehicle-filters-trigger__button');
			var hasLocations = document.querySelectorAll('.checkbox__label-checkbox.checked').length > 0;
			console.log(filterHeader);
			console.log(vehicleTypeFilter);
			console.log(hasLocations);

			if(!filterHeader.querySelector('.location-search-filter__clear-all')){
				if(vehicleTypeFilter.innerText == 'All Vehicles' && hasLocations){
					filterHeader.insertAdjacentHTML('beforeend',isoTest.clearBtn);
				}
			} else {
				if(vehicleTypeFilter.innerText == 'All Vehicles' && !hasLocations){
					var clearBtn = filterHeader.querySelector('.location-search-filter__clear-all');
					filterHeader.removeChild(clearBtn);
				}
			}
		},
		updatePage : function(image, status) {
			isoTest.log("updatePage()");
			var allLocations = document.querySelectorAll('#location .search-results-wrapper .search-results ul .location-result-item');

			if (allLocations.length > 0) {
				var search;
				var imgSearch = image;

				if (image == "city") {
					imgSearch = isoTest.mapSelector;
				}

				for(var i = 0; i < allLocations.length; i++) {
					if (image == "city") {
						search = !allLocations[i].querySelector('.location-name i.icon');
					} else {
						search = allLocations[i].querySelector('[class*="'+ image +'"]');
					}

					if (search && !allLocations[i].classList.contains('location-result-item--no-result')) {
						if (status == "unchecked") {
							allLocations[i].setAttribute('data-active', 'hide');
						} else {
							allLocations[i].setAttribute('data-active', 'active');
						}
						var locationID = allLocations[i].querySelector('.location-result-item__cta.btn').id;

						helpers.elementLoaded('div[class*="'+ locationID +'"]', function() {
							var mapData = document.querySelectorAll('div[class*="'+ locationID +'"]');
							for(var x = 0; x < mapData.length; x++) {
								if (status == "unchecked") {
									mapData[x].style.display = "none";
								} else {
									mapData[x].style.display = "block";
								}
							}
						});
					}
				}

		    helpers.elementLoaded('img[src*="'+imgSearch+'"]', function() {
		      var selectedImages = document.querySelectorAll('img[src*="'+imgSearch+'"]');
					for(var i = 0; i < selectedImages.length; i++) {
						if (status == "unchecked") {
							selectedImages[i].parentNode.style.display = 'none';
							selectedImages[i].style.display = 'none';
						} else {
							selectedImages[i].parentNode.style.display = 'block';
							selectedImages[i].style.display = 'block';
						}
					}
				});
			}
		},
		updateOrder : function() {
			isoTest.log('updateOrder()');

			var allLocations = document.querySelectorAll('#location .search-results-wrapper .search-results ul .location-result-item[data-active="active"]');
			var noResults = document.querySelectorAll('.location-result-item--no-result');

			if (allLocations.length > 0) {
				if (document.querySelector('.iso-no-active-items')) {
					document.querySelector('.iso-no-active-items').remove();
				}

				for(var i = 0; i < allLocations.length; i++) {
					allLocations[i].querySelector('.location-index').innerHTML = i + 1;

					var locationID = allLocations[i].querySelector('.location-result-item__cta.btn').id;
					var mapData = document.querySelectorAll('div[class*="'+ locationID +'"]');

					for(var a = 0; a < mapData.length; a++) {
						mapData[a].innerHTML = i + 1;
					}
				}

				if (isoTest.locationsNumber != allLocations.length) {
					isoTest.locationsNumber = allLocations.length;
					isoTest.updateFilteredNumber();
				}
			} else {
				if (isoTest.locationsNumber != 0) {
					isoTest.locationsNumber = 0;
					isoTest.updateFilteredNumber();
				}

				if (document.querySelector('#location .search-results-wrapper .search-results ul')) {
					if (noResults.length == 0) {
						document.querySelector('#location .search-results-wrapper .search-results ul').insertAdjacentHTML('afterbegin', isoTest.noMatches);
					}

					if (noResults.length > 1) {
						document.querySelector('.iso-no-active-items').remove();
					}
				}
			}
		},
		checkModalForChange : function() {
			isoTest.log("checkModalForChange()");

			for (var key in isoTest.checkedFilters) {
				var filterEl = document.getElementById(key);

				if (isoTest.checkedFilters[key] == "false") {
					if (filterEl.classList.contains('checked')) {
						filterEl.classList.remove('checked');
					}
				} else {
					if (!filterEl.classList.contains('checked')) {
						filterEl.classList.add('checked');
					}
				}
			}
		},
		addEvents : function() {
			isoTest.log("addEvents()");
			document.querySelector('.iso-modal.iso-location-filters-modal .close-modal').addEventListener('click', function (e) {
				isoTest.fireTag('.close-modal','Filter Location Type: Close Icon');
				isoTest.checkModalForChange();
				isoTest.destroyModal();
			}, false);

			document.querySelector('.location-search-filter__container .location-type-filters-trigger__button').addEventListener('click', function (e) {
				isoTest.fireTag('.location-type-filters-trigger__button','Filter Location Type: Open Modal');
				isoTest.modalOpen();
			}, false);

			document.querySelector('.iso-location-filters-modal.iso-modal .iso-modal-apply').addEventListener('click', function(e){
				var allchecked = document.querySelectorAll('.iso-location-filters-modal.iso-modal .checkbox__label-checkbox.checked');
				var checkedString = 'Filter Location Type: ';
				if (allchecked.length > 0) {
					for (var i = 0; i < allchecked.length; i++) {
						var val = allchecked[i].querySelector('.location-type-checkbox').value;
						if (checkedString == 'Filter Location Type: ') {
							checkedString += val;
						} else {
							checkedString += ', ' + val;
						}
					}
				} else {
					checkedString += 'Filters Cleared';
				}

				isoTest.fireTagApply('.iso-modal-apply','Filter Location Type: Apply CTA', checkedString);
				isoTest.destroyModal();
			}, false);

			document.querySelector('.iso-location-filters-modal.iso-modal .iso-modal-cancel').addEventListener('click', function(e){
				isoTest.fireTag('.iso-modal-cancel','Filter Location Type: Cancel CTA');
				isoTest.checkModalForChange();
				isoTest.destroyModal();
			}, false);

			document.querySelector('.iso-location-filters-modal.iso-modal .iso-clear-location-filter').addEventListener('click', function(e){
				var allchecked = document.querySelectorAll('.iso-location-filters-modal.iso-modal .checkbox__label-checkbox.checked');
				if (allchecked.length > 0) {
					for (var i = 0; i < allchecked.length; i++) {
						allchecked[i].classList.remove('checked');
					}
					isoTest.fireTag('.iso-clear-location-filter','Filter Location Type: Clear Filter');
				}
			}, false);

			document.querySelector('#location').addEventListener('click', function (event) {
			//	isoTest.log(event.target);

				if (event.target.classList.contains('modal-button')) {
					isoTest.updateFilterCaptionText();
				}

				if (event.target.classList.contains('iso-location-chicklet-clear') || event.target.classList.contains('iso-icon-location-close')) {
					isoTest.updateForNewLocation();
				}

				if (event.target.classList.contains('location-result-item__cta')) {
					window.clearInterval(isoTest.counter);
					if (isoTest.filtersCheckedNumber != 0) {
						isoTest.filtersCheckedNumber = 0;
						document.querySelector('.location-type-filters-trigger__button').innerHTML = 'All Locations<i class="icon icon-nav-carrot-down"></i>';
					}

					var allchecked = document.querySelectorAll('.iso-location-filters-modal.iso-modal .checkbox__label-checkbox.checked');
					if (allchecked.length > 0) {
						for (var i = 0; i < allchecked.length; i++) {
							allchecked[i].classList.remove('checked');
						}
					}

					for (var key in isoTest.checkedFilters) {
						isoTest.checkedFilters[key] = "false";
					}

					isoTest.filtersCheckedNumber = 0;
				}

				if(event.target.classList.contains('location-search-filter__clear-all')){
					var allchecked = document.querySelectorAll('.iso-location-filters-modal.iso-modal .checkbox__label-checkbox.checked');
					if (allchecked.length > 0) {
						for (var i = 0; i < allchecked.length; i++) {
							allchecked[i].classList.remove('checked');
						}
						isoTest.checkForFilters();
					}
				}
				//Tracking
				if(event.target.name == 'location-search'){
					isoTest.fireTag(event.target, 'Filter Location Type: ' + event.target.value);
				}

			}, false);


			document.addEventListener("keydown", function (e) {
				var keyCode = (e.keyCode ? e.keyCode : e.which);

        if (keyCode == '27') {
          if (document.querySelector('html').classList.contains('iso-modal-open')) {
          	isoTest.fireTag('esc','Filter Location Type: Close');
            isoTest.destroyModal();
          }
        }
			}, false);


			var filterElements = document.querySelectorAll('.iso-location-filters-modal.iso-modal .location-search-filters-modal__location-search-list .checkbox__label .location-type-checkbox');
			
			for(var i = 0; i < filterElements.length; i++) {
				console.log("Filter Elements: " + filterElements[i]);
				filterElements[i].addEventListener('click', function(e){
					console.log('clicked checkbox');
					console.log(e.target.parentNode.classList);
					if (e.target.parentNode.classList.contains('checked')) {
						console.log('checked');
						e.target.parentNode.classList.remove('checked');
					} else {
						console.log('not checked');
						e.target.parentNode.classList.add('checked');
					}
		    }, false);
			}
		},
		updateForNewLocation : function () {
			isoTest.log("updateForNewLocation()");
			window.clearInterval(isoTest.counter);

			if (isoTest.filtersCheckedNumber != 0) {
				isoTest.filtersCheckedNumber = 0;
				document.querySelector('.location-type-filters-trigger__button').innerHTML = 'All Locations<i class="icon icon-nav-carrot-down"></i>';
			}

			var allchecked = document.querySelectorAll('.iso-location-filters-modal.iso-modal .checkbox__label-checkbox.checked');
			if (allchecked.length > 0) {
				for (var i = 0; i < allchecked.length; i++) {
					allchecked[i].classList.remove('checked');
				}
			}

			for (var key in isoTest.checkedFilters) {
				isoTest.checkedFilters[key] = "false";
			}

			isoTest.filtersCheckedNumber = 0;

			var checkedLocations = document.querySelectorAll('.checkbox__label-checkbox');

			for(var x = 0; x < checkedLocations.length; x++) {
				var checkedLocationID = checkedLocations[x].id;
				isoTest.checkedFilters[checkedLocationID] = 'false';
				isoTest.updatePage(checkedLocationID,'checked');
			}

			isoTest.updateOrder();

			var locationTypeFiltersTriggerBtn = document.querySelector('.location-search-filter__container .location-search-filter__location-type-filter .location-type-filters-trigger__button');

			locationTypeFiltersTriggerBtn.disabled = true;
			locationTypeFiltersTriggerBtn.classList.add('disabled');

			document.querySelector('.iso-location-chicklet-clear').remove();
			document.querySelector('.location-chicklet-clear').click();

			helpers.elementLoaded('#location .search-results-wrapper .search-results ul .location-result-item.active .location-result-item__cta', function() {
				locationTypeFiltersTriggerBtn.disabled = false;
				locationTypeFiltersTriggerBtn.classList.remove('disabled');
				isoTest.addAttributeToAllLocations();
				isoTest.addLocationClearIcon();
			});
		},
		updateFilterCaptionText : function() {
			isoTest.log("updateFilterCaptionText()");
			var filterCaptionDesktopText = document.querySelector('.location-search-filter__container .location-search-filter__container-content-text.desktop').innerHTML;
			var filterCaptionMobile = document.querySelector('.location-search-filter__container .location-search-filter__container-content-text.mobile');

			filterCaptionMobile.innerHTML = filterCaptionDesktopText;
		},
		updateFilteredNumber : function() {
			isoTest.log("updateFilteredNumber()");
			document.querySelector('.iso-results-num').innerHTML = isoTest.locationsNumber + " Results";
			document.querySelector('.search-results-count small').innerHTML = isoTest.locationsNumber + " Results";
		},
		modalOpen : function() {
			window.clearInterval(isoTest.counter);

			document.querySelector('.iso-modal.iso-location-filters-modal').classList.add('active');
			document.querySelector('html').classList.add('iso-modal-open');

      var modalFocus = document.querySelector('.iso-modal.iso-location-filters-modal');
      isoTest.keepFocus(modalFocus);

      modalFocus.querySelector('.close-modal').focus();
		},
		destroyModal : function() {
			isoTest.log("destroyModal()");
      document.querySelector('html').classList.remove('iso-modal-open');
      var elModal = document.querySelector('.iso-modal.iso-location-filters-modal');
			elModal.classList.remove('active');

			isoTest.counter = window.setInterval(function(){isoTest.checkForFilters();},100);
    },
    keepFocus : function(context) {
      var allTabbableElements = context.querySelectorAll(isoTest.tabbableElements),
          firstTabbableElement = allTabbableElements[0],
          lastTabbableElement = allTabbableElements[allTabbableElements.length - 1];
      var keyListener = function(e) {
    		var keyCode = e.which || e.keyCode;

    		e.preventDefault = e.preventDefault || function () {
    			e.returnValue = false;
    		};
    		if (keyCode === 9) {
          if (e.target === lastTabbableElement && !e.shiftKey) {
    				e.preventDefault();
    				firstTabbableElement.focus();
          } else if (e.target === firstTabbableElement && e.shiftKey) {
    				e.preventDefault();
    				lastTabbableElement.focus();
    			}
    		}
    	};
    	context.addEventListener('keydown', keyListener, false);
    },
		fireTag : function(element, value) {
			var linkName = value ? value : element.innerText;
				linkName = isoTest.test ? isoTest.test + ' : ' + linkName : linkName;
			s.linkTrackVars = 'eVar20';
			s.eVar20 = linkName;
			s.tl(this, 'o', linkName);
		},
		fireTagApply : function(element, value, items) {
			var linkName = value ? value : element.innerText;
				linkName = isoTest.test ? isoTest.test + ' : ' + linkName : linkName;
			var checkedName = items;
				checkedName = isoTest.test ? isoTest.test + ' : ' + checkedName : checkedName;
			s.linkTrackVars = 'eVar20,eVar89';
			s.eVar20 = linkName;
			s.eVar89 = checkedName;
			s.tl(this, 'o', linkName, checkedName);
		},
		log : function(obj){
			if(isoTest.debug === true){
				console.log(obj);
			}
		}
	}

	var helpers = {
		elementLoaded : function (ele, callback) {
			isoTest.log('elementLoaded::  ' + ele + ' - Checking...');
			window.clearTimeout(isoTest.eleTimer);
			if (document.querySelectorAll(ele).length > 0) {
				if (typeof callback === 'function') {
					isoTest.log('elementLoaded::  ' + ele + ' - Found!');
					callback();
				}
	        } else {
	            isoTest.eleTimer = window.setTimeout(function(){helpers.elementLoaded(ele, callback);}, 100);
	        }
		}
	}

	isoTest.init();
})();
</script>
