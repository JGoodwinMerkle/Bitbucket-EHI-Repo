<style>
@media screen and (max-width: 748px) {
	.reservation-steps-container .mobile-reservation-nav-slider {
		padding-bottom: 17px;
		padding-top: 17px;
	}

	.reservation-steps-container .mobile-reservation-nav-slider i.arrow {
		border-width: 0 2px 2px 0;
		padding: 4px;
		top: 48%;
	}

	.iso-header {
		align-items: center;
		display: flex;
		justify-content: space-between;
		width: 90%;
	}

	.iso-header .iso-header-step {
		display: inline-flex;
	}

	.iso-header .iso-header-step .step__step-title {
		color: #181918;
		display: inline-flex;
		margin: 0;
	}

	.iso-header .iso-header-step .iso-step-title {
		display: none;
	}

	.iso-header .iso-header-step.step-active .iso-step-title {
		display: inline-block;
		font-size: 14px;
		font-weight: 700;
		margin-left: 8px;
	}

	.iso-header .iso-header-step .step__step-index {
		border: 2px solid #181918;
		margin:	0;
	}

	.iso-header .iso-header-step.step-active .step__step-index {
		background-color: black;
	}

	.iso-header .iso-header-step .step__step-index .iso-step-number {
		color: #181918;
		font-weight: 600;
	}

	.iso-header .iso-header-step.step-active .step__step-index .iso-step-number {
		color: #F3F3F3;
	}

	.iso-header .step__arrow {
		background: url("data:image/svg+xml;charset=UTF-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3Csvg%0A%20%20%20xmlns%3Adc%3D%22http%3A//purl.org/dc/elements/1.1/%22%0A%20%20%20xmlns%3Acc%3D%22http%3A//creativecommons.org/ns%23%22%0A%20%20%20xmlns%3Ardf%3D%22http%3A//www.w3.org/1999/02/22-rdf-syntax-ns%23%22%0A%20%20%20xmlns%3Asvg%3D%22http%3A//www.w3.org/2000/svg%22%0A%20%20%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%0A%20%20%20viewBox%3D%220%200%2053.333332%2050.093334%22%0A%20%20%20height%3D%2250.093334%22%0A%20%20%20width%3D%2253.333332%22%0A%20%20%20xml%3Aspace%3D%22preserve%22%0A%20%20%20version%3D%221.1%22%0A%20%20%20id%3D%22svg2%22%3E%3Cmetadata%0A%20%20%20%20%20id%3D%22metadata8%22%3E%3Crdf%3ARDF%3E%3Ccc%3AWork%0A%20%20%20%20%20%20%20%20%20rdf%3Aabout%3D%22%22%3E%3Cdc%3Aformat%3Eimage/svg+xml%3C/dc%3Aformat%3E%3Cdc%3Atype%0A%20%20%20%20%20%20%20%20%20%20%20rdf%3Aresource%3D%22http%3A//purl.org/dc/dcmitype/StillImage%22%20/%3E%3C/cc%3AWork%3E%3C/rdf%3ARDF%3E%3C/metadata%3E%3Cdefs%0A%20%20%20%20%20id%3D%22defs6%22%3E%3CclipPath%0A%20%20%20%20%20%20%20id%3D%22clipPath18%22%0A%20%20%20%20%20%20%20clipPathUnits%3D%22userSpaceOnUse%22%3E%3Cpath%0A%20%20%20%20%20%20%20%20%20id%3D%22path20%22%0A%20%20%20%20%20%20%20%20%20d%3D%22m%200%2C0%20400%2C0%200%2C375.652%20-400%2C0%20L%200%2C0%20Z%22%20/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%0A%20%20%20%20%20transform%3D%22matrix%281.3333333%2C0%2C0%2C-1.3333333%2C0%2C50.093333%29%22%0A%20%20%20%20%20id%3D%22g10%22%3E%3Cg%0A%20%20%20%20%20%20%20transform%3D%22scale%280.1%29%22%0A%20%20%20%20%20%20%20id%3D%22g12%22%3E%3Cg%0A%20%20%20%20%20%20%20%20%20id%3D%22g14%22%3E%3Cg%0A%20%20%20%20%20%20%20%20%20%20%20clip-path%3D%22url%28%23clipPath18%29%22%0A%20%20%20%20%20%20%20%20%20%20%20id%3D%22g16%22%3E%3Cpath%0A%20%20%20%20%20%20%20%20%20%20%20%20%20id%3D%22path22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20style%3D%22fill%3A%23000000%3Bfill-opacity%3A1%3Bfill-rule%3Anonzero%3Bstroke%3Anone%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20d%3D%22m%20385.004%2C172.965%20-370.004%2C0%20c%20-8.28516%2C0%20-15%2C6.711%20-15%2C15%200%2C8.285%206.71484%2C15%2015%2C15%20l%20333.793%2C0%20-147.09%2C147.082%20c%20-5.859%2C5.855%20-5.859%2C15.359%200%2C21.211%205.859%2C5.859%2015.352%2C5.859%2021.211%2C0%20L%20395.609%2C198.57%20c%204.289%2C-4.289%205.579%2C-10.742%203.254%2C-16.347%20-2.324%2C-5.606%20-7.793%2C-9.258%20-13.859%2C-9.258%22%20/%3E%3Cpath%0A%20%20%20%20%20%20%20%20%20%20%20%20%20id%3D%22path24%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20style%3D%22fill%3A%23000000%3Bfill-opacity%3A1%3Bfill-rule%3Anonzero%3Bstroke%3Anone%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20d%3D%22m%20212.309%2C0%20c%20-3.836%2C0%20-7.676%2C1.46484%20-10.606%2C4.39453%20-5.859%2C5.85937%20-5.859%2C15.35157%200%2C21.21097%20L%20302.66%2C126.551%20c%205.86%2C5.859%2015.352%2C5.859%2021.211%2C0%205.859%2C-5.86%205.859%2C-15.352%200%2C-21.211%20L%20222.914%2C4.39453%20C%20219.984%2C1.46484%20216.148%2C0%20212.309%2C0%22%20/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A");
	    background-repeat: no-repeat;
	   	background-size: 11px auto;
	    display: inline-block;
	    height: 10px;
	    vertical-align: top;
	    width: 11px;
	}
}

@media screen and (max-width: 374px) {
	.iso-header .iso-header-step.step-active .iso-step-title {
		display: none;
	}
}
</style>
<script>
(function() {
	'use strict';
	var isoTest = {
		account : 'Enterprise',
		portfolio : 'Enterprise.com',
		test : 'Vehicle Selection Mobile Progress Bar 2.0',
		creative : 'Challenger 3',
		selector: '[data-stephash="dateTime"] .step-completed',
		menuItems: {
			dateTime: (document.querySelector('[data-stephash="dateTime"] .step-active') ? true : false),
			location: (document.querySelector('[data-stephash="location"] .step-active') ? true : false),
			locationPickup: (document.querySelector('[data-stephash="location/pickup"] .step-active') ? true : false),
			locationDropoff: (document.querySelector('[data-stephash="location/dropoff"] .step-active') ? true : false),
			cars: (document.querySelector('[data-stephash="cars"] .step-active') ? true : false),
			extras: (document.querySelector('[data-stephash="extras"] .step-active') ? true : false)
		},
		template: '<div class="iso-header-step {complete} {active}">\
						<div class="step__step-title">\
							<span class="step__step-index">\
								<span class="iso-step-number">{num}</span>\
							</span>\
							<span class="iso-step-title">{title}</span>\
						</div>\
					</div>',
		init : function() {

			isoTest.debug = ${user.mvtDebug};
			
			if (_satellite && typeof _satellite.setVar === 'function' && typeof _satellite.track === 'function') {
				_satellite.setVar('TargetCampaign', isoTest.test);
				_satellite.setVar('TargetCreative', isoTest.creative);
				//_satellite.track('target_variables');
			}

			(document.querySelector('[data-stephash="location/dropoff"] .step-active') ? true : false)

			isoTest.log('Test Running...');
			isoTest.log(isoTest.account + ' - ' + isoTest.portfolio);
			isoTest.log(isoTest.test + ' - ' + isoTest.creative);

			isoTest.viewChange();
			
			window.addEventListener('hashchange', isoTest.viewChange, false);
		},
		viewChange : function(){
			if(/dateTime|location|cars|extras/.test(location.hash)){
				isoTest.log('VIEW CHANGE ----');
				helpers.elementLoaded(isoTest.selector, function() {
					isoTest.log('Test Ready!');
					isoTest.chall();
				});
			}
		},
		chall : function() {
			isoTest.log('chall()');

			isoTest.updateHeader();
			isoTest.checkPageUpdate();
		},
		checkPageUpdate : function() {
			isoTest.log('checkPageUpdate()');

			isoTest.log(isoTest.menuItems);

			var checkMenuItems = setInterval(function(){
				var newMenuItems = {
					dateTime: (document.querySelector('[data-stephash="dateTime"] .step-active') ? true : false),
					location: (document.querySelector('[data-stephash="location"] .step-active') ? true : false),
					locationPickup: (document.querySelector('[data-stephash="location/pickup"] .step-active') ? true : false),
					locationDropoff: (document.querySelector('[data-stephash="location/dropoff"] .step-active') ? true : false),
					cars: (document.querySelector('[data-stephash="cars"] .step-active') ? true : false),
					extras: (document.querySelector('[data-stephash="extras"] .step-active') ? true : false)
				};

				if (isoTest.menuItems["dateTime"] != newMenuItems["dateTime"]) {
					isoTest.log("dateTime not the same");
					isoTest.log(newMenuItems["dateTime"]);
					isoTest.menuItems["dateTime"] = newMenuItems["dateTime"];
					isoTest.updateHeader();
				}

				if (isoTest.menuItems["location"] != newMenuItems["location"]) {
					isoTest.log("location not the same");
					isoTest.log(newMenuItems["location"]);
					isoTest.menuItems["location"] = newMenuItems["location"];
					isoTest.updateHeader();
				}

				if (isoTest.menuItems["locationPickup"] != newMenuItems["locationPickup"]) {
					isoTest.log("locationPickup not the same");
					isoTest.log(newMenuItems["locationPickup"]);
					isoTest.menuItems["locationPickup"] = newMenuItems["locationPickup"];
					isoTest.updateHeader();
				}
				

				if (isoTest.menuItems["locationDropoff"] != newMenuItems["locationDropoff"]) {
					isoTest.log("locationDropoff not the same");
					isoTest.log(newMenuItems["locationDropoff"]);
					isoTest.menuItems["locationDropoff"] = newMenuItems["locationDropoff"];
					isoTest.updateHeader();
				}

				if (isoTest.menuItems["cars"] != newMenuItems["cars"]) {
					isoTest.log("cars not the same");
					isoTest.log(newMenuItems["cars"]);
					isoTest.menuItems["cars"] = newMenuItems["cars"];
					isoTest.updateHeader();
				}

				if (isoTest.menuItems["extras"] != newMenuItems["extras"]) {
					isoTest.log("extras not the same");
					isoTest.log(newMenuItems["extras"]);
					isoTest.menuItems["extras"] = newMenuItems["extras"];
					isoTest.updateHeader();
				}
			},100);

			setTimeout(function(){ clearInterval(checkMenuItems) }, 10000);
		},
		updateHeader : function() {
			isoTest.log('updateHeader()');

			var steps = document.querySelectorAll('.step');

			document.querySelector('.reservation-steps-container .mobile-reservation-nav-slider').innerHTML = '<span class="iso-header"></span><i class="arrow down"></i>';

			var arrow = '<div class="step__arrow"></div>';
			var header = document.querySelector('.reservation-steps-container .mobile-reservation-nav-slider .iso-header');

			for(var i=0;i < steps.length; i++){ 
				var stringTitle = steps[i].querySelector('.step__step-title').childNodes;
				var titleTxt = helpers.getInnerText(stringTitle);
				var completedStep = '';
				var activeStep = '';

				if (steps[i].querySelector('.step__item').classList.contains('step-completed')) {
					completedStep = 'step-completed';
				}

				if (steps[i].querySelector('.step__item').classList.contains('step-active')) {
					completedStep = 'step-active';
				}

				var progressHeader = helpers.supplant(isoTest.template,{
					'num' : i + 1,
					'title' : titleTxt,
					'complete' : completedStep,
					'active' : activeStep
				});

				header.insertAdjacentHTML('beforeend', progressHeader);

				if (i+1 != steps.length) {
					header.insertAdjacentHTML('beforeend', arrow);
				}
			}
		},
		log : function(obj){
			if(isoTest.debug === true){
				console.log(obj);
			}
		}

	}

	var helpers = {
		elementLoaded : function (ele, callback) {
			isoTest.log('elementLoaded::  ' + ele + ' - Checking...');
			window.clearTimeout(isoTest.eleTimer);
			if (document.querySelectorAll(ele).length > 0) {
				if (typeof callback === 'function') {
					isoTest.log('elementLoaded::  ' + ele + ' - Found!');
					callback();
				}
	        } else {
	            isoTest.eleTimer = window.setTimeout(function(){helpers.elementLoaded(ele, callback);}, 100);
	        }
		},
	    supplant : function(str, o) {
			return str.replace(/{([^{}]*)}/g, function(a, b) {
		        var p = b.split(/\./),
		            c = o;
		        for (var i = 0; i < p.length; i++) {
		          if (c[p[i]] == null)
		            return a;
		          c = c[p[i]];
		        }
				return typeof c === 'string' || typeof c === 'number' ? c : a;
			});
		},
		getInnerText : function(nodes) {
  			var innerText='';
  			nodes.forEach(function(n){
    			if(n.nodeType === 3){
        			innerText += n.nodeValue;
    			}
  			});
  			return innerText;
		}
	}

	isoTest.init();
})();
</script>
