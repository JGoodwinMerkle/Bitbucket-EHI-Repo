<style>
#commit .pre-expedited-banner {
	margin: 0 0 24px;
}

#commit .iso-desktop-driver-message {
	background-color: #393A3B;
	display: block;
	margin: 0 0 50px;
	width: 100%;
}

#commit .iso-mobile-driver-message {
	display: none;
}

#commit .iso-container {
	display: flex;
	padding: 16px 24px 14px;
}

#commit .icon.iso-check-icon {
	background-image: url('https:/\/\www.enterprise.co.uk/content/dam/eu-cro/eucro-hp-benefits-icon-tick.png');
	margin-top: 3px;
}

#commit .iso-banner-text-container {
	color: #FFFFFF;
	font-size: 16px;
	font-weight: 300;
	line-height: 20px;
	margin-left: 8px;
}

#commit .iso-banner-text-container .iso-bold {
	font-weight: 700;
}

.iso-driverTooltip {
	cursor: pointer;
	display: inline-block;
	position: relative;
}

.iso-driverTooltip .iso-tooltip-container {
	display: block;
	position: absolute;
  width: 100%;
  visibility: hidden;
}

.iso-driverTooltip .iso-tooltip-container.active {
	visibility: visible;
}

.iso-driverTooltip .iso-btn-tooltip {
	background: transparent;
	color: #FFFFFF;
	cursor: pointer;
  font-size: 16px;
  font-weight: 300;
  letter-spacing: normal;
  margin: 0;
  padding: 0;
  text-decoration: underline;
  text-transform: initial;
}

.iso-driverTooltip .iso-tooltip-info__arrow {
	border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-top: 11px solid #707070;
  display: block;
	height: 0;
  left: 42%;
  margin:	0;
  position: absolute;
  top: 2px;
  transform: rotate(-180deg);
  width: 0;
  z-index: 2;
}

.iso-driverTooltip .iso-tooltip-container .tooltip-info__content {
	background-color: #707070;
	display: block;
	font-size: 12px;
	min-height: 114px;
	line-height: 16px;
	left: 50%;
  margin-left: -113.5px;
  padding: 10px 27px 10px 10px;
  position: relative;
  text-align: left;
  top: 9px;
  transform: none;
  visibility: hidden;
  width: 227px;
}

.iso-driverTooltip .iso-tooltip-container.active .tooltip-info__content {
	visibility: visible;
}

.iso-driverTooltip .tooltip-info__close,
.iso-driverTooltip .tooltip-info__close .icon.icon-close-white {
	height: 12px;
	width: 12px;
}

.iso-driverTooltip .tooltip-info__cta {
	font-weight: normal;
}

.iso-driverTooltip .tooltip-info__cta.tooltip-info__icon-button {
	position: relative;
  top: 14px;
}

@media (max-width: 748px) {
	#commit .pre-expedited-banner {
		margin: 0 0 50px;
	}

	#commit .iso-desktop-driver-message {
		display: none;
	}

	#commit .iso-mobile-driver-message {
		background-color: #393A3B;
		display: block;
		margin: 0 0 26px;
		position: relative;
		width: 100%;
	}

	#commit .iso-container {
		padding: 12px;
	}

	#commit .icon.iso-check-icon {
		height: 17px;
		width: 17px;
	}

	#commit .iso-banner-text-container {
		font-size: 13px;
		line-height: 17px;
	}

	#commit .iso-banner-text-container .iso-btn-tooltip {
		font-size: 13px;
	}
}
</style>
<script>
(function() {
	'use strict';
	var isoTest = {
		account : 'Enterprise',
		portfolio : 'Enterprise.fr Enterprise.de Enterprise.ie Enterprise.es',
		test : '(CONV) ENT 013 - Additional Driver Reassurance EU',
		creative : 'Challenger 1',
		selector: '#personal-information',
		content: {
			en_IE : {
				text: "Good news - You can <span class='iso-bold'>add an additional driver</span> in branch when you pick up your car! Just bring the <div class='iso-button-container iso-driverTooltip'></div> with you!",
				tooltip: "All drivers must present a full valid driving license. If the driving license is written in a language and characters different to those of the country of rental, an International Driving Permit is also required.",
				buttontext: "required documents"
			},
			es_ES : {
				text: "Buenas noticias - Puede <span class='iso-bold'>añadir un conductor extra</span> en la sucursal cuando recoja su coche - solo traiga <div class='iso-button-container iso-driverTooltip'></div>!",
				tooltip: "Todos los conductores deben presentar un carnet de conducir. Si el carnet de conducir está escrito en un idioma y caracteres diferentes al del país de alquiler, se necesitará un carnet de conducir internacional.",
				buttontext: "los documentos necesarios"
			},
			fr_FR : {
				text: "Bonne nouvelle ! Vous pouvez <span class='iso-bold'>ajouter un conducteur supplémentaire</span> en agence lors de votre départ! Pensez juste à apporter <div class='iso-button-container iso-driverTooltip'></div>!",
				tooltip: "Tous les conducteurs doivent présenter un permis de conduire en cours de validité. Si le permis de conduire est écrit dans une langue aux caractères différents de celui du pays de location, un permis international est également demandé.",
				buttontext: "les documents nécessaires"
			},
			de_DE : {
				text: "Gute Nachrichten! Sie können die <span class='iso-bold'>Zusatzfahrer-Option</span> direkt in der Filiale buchen, wenn Sie Ihr Fahrzeug abholen. Bringen Sie einfach die für Zusatzfahrer <div class='iso-button-container iso-driverTooltip'></div> mit!",
				tooltip: "Alle zusätzlichen Fahrer müssen einen gültigen Führerschein vorlegen. Wenn sich die Sprache des Führerscheins und dessen Alphabet von denen des Mietlandes unterscheiden, ist zusätzlich ein internationaler Führerschein erforderlich.",
				buttontext: "benötigten Dokumente"
			}
		},
		template: "<div class='iso-container'>\
								<div class='iso-icon-container'><i class='icon iso-check-icon'></i></div>\
								<div class='iso-banner-text-container'>{text}</div>\
							</div>",
		tooltip: "<button class='iso-btn-tooltip'>{buttontext}</button>\
							<div class='iso-tooltip-container'>\
								<span class='iso-tooltip-info__arrow'></span>\
								<span class='tooltip-info__content' aria-describedby='tooltip_driver_reassurance' role='tooltip'>\
										<button type='button' class='tooltip-info__close' aria-label='Close'><i class='icon icon-close-white'></i></button>\
										<span class='tooltip-info__description' id='tooltip_driver_reassurance'>{tooltip}</span>\
								</span>\
							</div>",
		init : function() {

			isoTest.debug = ${user.mvtDebug};
			
			if (_satellite && typeof _satellite.setVar === 'function' && typeof _satellite.track === 'function') {
				_satellite.setVar('TargetCampaign', isoTest.test);
				_satellite.setVar('TargetCreative', isoTest.creative);
				//_satellite.track('target_variables');
			}

			isoTest.log('Test Running...');
			isoTest.log(isoTest.account + ' - ' + isoTest.portfolio);
			isoTest.log(isoTest.test + ' - ' + isoTest.creative);

			helpers.elementLoaded(isoTest.selector, function() {
				isoTest.log('Test Ready!');
  				isoTest.chall();
			});
			
		window.addEventListener('hashchange', isoTest.viewChange, false);
		
		},
		viewChange : function(){
			if(/commit/.test(location.hash)){
				helpers.elementLoaded(isoTest.selector, function() {
					isoTest.chall();
				});
			}
		},
		chall : function() {
			isoTest.log("chall()");
			var lang = enterprise.locale;

			var tooltipContent = helpers.supplant(isoTest.tooltip,{
				'tooltip' : isoTest.content[lang].tooltip,
				'buttontext' : isoTest.content[lang].buttontext
			});

			var banner = helpers.supplant(isoTest.template,{
				'text' : isoTest.content[lang].text
			});


			if (!document.querySelector('.iso-desktop-driver-message')) {
				document.querySelector('#commit .review-section #personal-information').insertAdjacentHTML('beforebegin',"<div class='iso-desktop-driver-message'>"+ banner +"</div>");
				document.querySelector('#commit .iso-desktop-driver-message .iso-button-container').insertAdjacentHTML('afterbegin', tooltipContent);
			}

			if (!document.querySelector('.iso-mobile-driver-message')) {
				document.querySelector('#commit .aside').insertAdjacentHTML('afterbegin',"<div class='iso-mobile-driver-message'>"+ banner +"</div>");
				document.querySelector('#commit .iso-mobile-driver-message .iso-button-container').insertAdjacentHTML('afterbegin', tooltipContent);
			}

			isoTest.addTooltip();

			if (window.innerWidth <= 748) {
				isoTest.checkTooltipPosition();
			}

			window.addEventListener('resize', function(event){
				isoTest.log('window resized');
				if (window.innerWidth <= 748) {
					isoTest.log('mobile size');
					isoTest.checkTooltipPosition();
				}
			});

		},
		addTooltip: function() {
			isoTest.log("addTooltip()");
			document.querySelector('.iso-desktop-driver-message .iso-driverTooltip .iso-btn-tooltip').addEventListener('click', isoTest.toggleTooltip);
			document.querySelector('.iso-desktop-driver-message .iso-driverTooltip .tooltip-info__close').addEventListener('click', isoTest.toggleTooltip);

			document.querySelector('.iso-mobile-driver-message .iso-driverTooltip .iso-btn-tooltip').addEventListener('click', isoTest.toggleTooltip);
			document.querySelector('.iso-mobile-driver-message .iso-driverTooltip .tooltip-info__close').addEventListener('click', isoTest.toggleTooltip);
		},
		toggleTooltip : function() {
			isoTest.log("toggleTooltip()");
			var tooltipDesktop = document.querySelector('.iso-desktop-driver-message .iso-driverTooltip .iso-tooltip-container');
			var tooltipMobile = document.querySelector('.iso-mobile-driver-message .iso-driverTooltip .iso-tooltip-container');

			if(tooltipDesktop.classList.contains('active') || tooltipMobile.classList.contains('active')){
				tooltipDesktop.classList.remove('active');
				tooltipMobile.classList.remove('active');

				document.querySelector('.iso-desktop-driver-message .iso-btn-tooltip').focus();
				document.querySelector('.iso-mobile-driver-message .iso-btn-tooltip').focus();
			} else {
				isoTest.fireTag('.iso-btn-tooltip', 'Required Documents');
				tooltipDesktop.classList.add('active');
				tooltipMobile.classList.add('active');

				tooltipDesktop.querySelector('.tooltip-info__close').focus();
				tooltipMobile.querySelector('.tooltip-info__close').focus();
			}
		},
		checkTooltipPosition : function() {
			isoTest.log("checkTooltipPosition()");
			var mobileTooltip = document.querySelector('.iso-mobile-driver-message .tooltip-info__content');
			var mobileTooltip_rect = mobileTooltip.getBoundingClientRect();
			var mobileBanner_rect = document.querySelector('.iso-mobile-driver-message .iso-container').getBoundingClientRect();

			var mobileTooltipContainer = document.querySelector('.iso-mobile-driver-message .iso-tooltip-container');
			var mobileTooltipArrow = document.querySelector('.iso-mobile-driver-message .iso-tooltip-container .iso-tooltip-info__arrow');

			var windowSize = window.innerWidth;

			if (mobileTooltip_rect.right > mobileBanner_rect.right ) {
				var right = windowSize - mobileBanner_rect.right + 15;
				mobileTooltipContainer.style.right = right + 'px';
				mobileTooltipArrow.style.marginLeft = right + 'px';
			} else {
				if (mobileTooltip_rect.left < mobileBanner_rect.left ) {
					var left = mobileBanner_rect.left + 15;
					mobileTooltipContainer.style.right = '-' + left + 'px';
					mobileTooltipArrow.style.marginLeft = '-' + left + 'px';
				} 
			}
		},
		fireTag : function(element, value) {
			isoTest.log("fireTag()");
			var linkName = value ? value : element.innerText;
				linkName = isoTest.test ? isoTest.test + ' : ' + linkName : linkName;
			s.linkTrackVars = 'eVar20';
			s.eVar20 = linkName;
			s.tl(this, 'o', linkName);
		},
		log : function(obj){
			if(isoTest.debug === true){
				console.log(obj);
			}
		}

	}

	var helpers = {
		elementLoaded : function (ele, callback) {
			isoTest.log('elementLoaded::  ' + ele + ' - Checking...');
			window.clearTimeout(isoTest.eleTimer);
			if (document.querySelectorAll(ele).length > 0) {
				if (typeof callback === 'function') {
					isoTest.log('elementLoaded::  ' + ele + ' - Found!');
					callback();
				}
	        } else {
	            isoTest.eleTimer = window.setTimeout(function(){helpers.elementLoaded(ele, callback);}, 100);
	        }
		},
	    supplant : function(str, o) {
			return str.replace(/{([^{}]*)}/g, function(a, b) {
		        var p = b.split(/\./),
		            c = o;
		        for (var i = 0; i < p.length; i++) {
		          if (c[p[i]] == null)
		            return a;
		          c = c[p[i]];
		        }
				return typeof c === 'string' || typeof c === 'number' ? c : a;
			});
		}
	}

	isoTest.init();
})();
</script>
