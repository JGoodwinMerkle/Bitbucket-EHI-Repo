<style>
.vehicle-header__sorted-by {
	display: none;
}
.vehicle-header__filter span {
	display: none;
}
.d-sort-select {
	font-size: .85rem;
	font-weight: 400;
}
.d-sort-select button {
	background: none;
	color: #169a5a;
	text-transform: none;
	font-weight: 400;
	letter-spacing: normal;
	font-size: inherit;
	padding: 0 15px 0 0;
	position: relative;
}
.d-sort-select button::after {
	content: '';
	background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjAuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxNC45IDE0LjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDE0LjkgMTQuNzsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgoJLnN0MHtmaWxsOiMxNjlBNUE7fQo8L3N0eWxlPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTQuMyw0LjhsLTEuMi0xLjJjLTAuMi0wLjItMC40LTAuMi0wLjYsMGwtNSw1LjFMMi4zLDMuNmMtMC4yLTAuMi0wLjQtMC4yLTAuNiwwTDAuNiw0LjgKCUMwLjQsNSwwLjQsNS4yLDAuNiw1LjRsNS4zLDUuM2MwLDAsMCwwLjEsMC4xLDAuMUw3LjIsMTJjMC4yLDAuMiwwLjQsMC4yLDAuNiwwbDAsMEw5LDEwLjhsNS40LTUuNEMxNC41LDUuMiwxNC41LDUsMTQuMyw0Ljh6Ii8+Cjwvc3ZnPgo=);
	background-size: 100%;
	background-color: transparent;
	background-repeat: no-repeat;
	background-position: center;
	position: absolute;
	top: 0;
	right: 0;
	bottom: 0;
	width: 12px;
	transition: transform 0.6s ease;
}
.d-sort-select-active button::after {
	transform: rotate(180deg);
}
.d-sort-modal {
	background: #313234;
	position: fixed;
	left: 0;
	right: 0;
	bottom: -100%;
	transition: bottom 0.6s ease;
	z-index: 1;
}
.d-sort-active {
	bottom: 0;		
}
.dsm-header {
	background: #1a1b1c;
	padding: 0 1.2em;
}
.dsm-body {
	padding: 1em 2em 2em 2em;
	text-align: center;
}
.d-sort-modal li {
	color: #fff;
	font-size: 1.2em;
}
.d-sort-modal button {
	background: none;
	color: #fff;
	text-transform: none;
	font-weight: 400;
	letter-spacing: normal;
	padding: 10px 15px
}
.d-sort-modal li button {
	width: 100%;
}
.dsm-ok {
	float: right;
}
.d-select-active {
	background: #3f4043;
	border-radius: 5px;
}
.d-sort-modal .dsm-down, .d-sort-modal .dsm-up {
	background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSItODAzIDI5NyA0MCA0MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAtODAzIDI5NyA0MCA0MCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8cG9seWdvbiBmaWxsPSIjRkZGRkZGIiBwb2ludHM9Ii03ODcuNywzMzcgLTc5Mi41LDMzMyAtNzc5LjUsMzE2LjggLTc5Mi4yLDMwMSAtNzg3LjMsMjk3IC03NzEuNSwzMTYuOCAiLz4NCjwvc3ZnPg0K);
	background-size: 50%;
	background-color: transparent;
	background-repeat: no-repeat;
	background-position: center;
    height: 20px;
    width: 20px;
    padding: 20px 16px;
    font-size: 0;
    transform: rotate(90deg);
}
.d-sort-modal .dsm-up {
	transform: rotate(270deg);
}
/* Pills */
.sort-pills-wrap {
	border-top: 1px solid #c3c3c3;
	position: relative;
}
.sort-pills-wrap::before, .sort-pills-wrap::after {
	content: '';
	background: linear-gradient(90deg, rgba(255,255,255,1) 0%, rgba(255,255,255,0) 100%);
	pointer-events: none;
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	width: 20px;
}
.sort-pills-wrap::after {
	right: 0;
	left: auto;
	transform: rotate(180deg);
}
.sort-pills {
	padding: 10px .9375rem;
	-ms-overflow-style: none;  /* Hide Scrollbar: Internet Explorer 10+ */
	overflow-x: scroll;
	scrollbar-width: none; /* Hide Scrollbar: Firefox */
	white-space: nowrap;
}
.sort-pills::-webkit-scrollbar { /* Hide Scrollbar: WebKit */
    width: 0;
    height: 0;
}
.sort-pills button {
	background: #fff;
	border: 2px solid #169a5a;
	border-radius: 20px;
	color: #169a5a;
	font-size: 11px;
	letter-spacing: normal;
	margin-left: 6px;
	padding: 4px 8px;
	text-transform: uppercase;
}
.sort-pills button[aria-selected="true"] {
    background: #006639;
    border: 2px solid #006639;
    color: #fff;
}
.sort-pills > span {
	font-size: 14px;
}
@media (min-width: 654px) {
	.d-sort-select {
		display: none;
	}
	.vehicle-header__filter span {
		display: inline;
	}
	/* Pills */
	.sort-pills {
		display: none;
	}
}
@media (min-width: 654px) and (max-width: 70.9375em) {
	.vehicle-header__sorted-by {
		display: block;
	}
}
</style>
<script>
(function() {
	'use strict';
	var isoTest = {
		account : 'EHI',
		portfolio : 'Enterprise',
		test : 'MVT-395',
		creative : 'Challenger 2',
		selector : '.vehicle-select__header',
		init : function() {

			isoTest.debug = ${user.mvtDebug};
			
			if (_satellite && typeof _satellite.setVar === 'function' && typeof _satellite.track === 'function') {
				_satellite.setVar('TargetCampaign', isoTest.test);
				_satellite.setVar('TargetCreative', isoTest.creative);
			}

			isoTest.log('Test Running...');
			isoTest.log(isoTest.account + ' - ' + isoTest.portfolio);
			isoTest.log(isoTest.test + ' - ' + isoTest.creative);

			helpers.elementLoaded(isoTest.selector, function() {
				isoTest.log('Test Ready!');
  				isoTest.chall();
			});
			
			window.addEventListener('hashchange', isoTest.viewChange, false);
		
		},
		viewChange : function(){
			if(/cars/.test(location.hash)){
				helpers.elementLoaded(isoTest.selector, function() {
					isoTest.chall();
				});
			}
		},
		chall : function() {
			if (!$('.sort-pills')) {
				$('.vehicle-select__header').insertAdjacentHTML('afterend','<div class="sort-pills-wrap"><div class="sort-pills"><span>Quick Filters:</span><button data-filter="Cars">Cars +</button><button data-filter="SUVs">SUVs +</button><button data-filter="Unlimited Mileage">Unlimited Mileage +</button></div></div>');
				$('.vehicle-header__filter').innerHTML = '<i class="icon icon-filter"></i> <span>Sort &&nbsp;</span> Filter';
				$('.vehicle-header__sorted-by').insertAdjacentHTML('afterend','<div class="d-sort-select">Sorted By: <button>Featured</button></div>');
				helpers.elementLoaded('.footer', function() {
					$('.footer').insertAdjacentHTML('afterend','<div class="d-sort-modal"><div class="dsm-header"><button class="dsm-down">Down</button><button class="dsm-up">Up</button><button class="dsm-ok">OK</button></div><div class="dsm-body"><ul><li><button class="dsm-feat">Featured</button></li><li><button class="dsm-lth">Low to High</button></li><li><button class="dsm-htl">High to Low</button></li></ul></div></div>');
				});
				isoTest.syncSorts();
				isoTest.events();
			}
		},
		syncSorts : function() {
			var observer = new MutationObserver(function(mutations) {
				mutations.forEach(function(mutation) {
					if (mutation.type === 'characterData') {
						isoTest.sortCheck();
					}
					if (mutation.type === 'attributes') {
						var filters = ['Cars', 'SUVs', 'Unlimited Mileage'];
						for (var i = 0; i < filters.length; i++) {
							if ($('input[value="'+filters[i]+'"]').checked === true ) {
								$('[data-filter="'+filters[i]+'"]').setAttribute('aria-selected','true');
							} else 
							if ($('input[value="'+filters[i]+'"]').checked === false ) {
								$('[data-filter="'+filters[i]+'"]').setAttribute('aria-selected','false');
							}
						}
					}
				});    
			});
			var observerConfig = { attributes: true, childList: true, subtree: true, characterData: true };
			observer.observe($('.vehicle-select__aside'), observerConfig);
			observer.observe($('.vehicle-header__details-group'), observerConfig);
		},
		sortCheck : function() {
			if ($('.vehicle-header__sorted-by').innerHTML.indexOf('Featured') > -1) {
				isoTest.isFeatured();
			}
			else
			if ($('.vehicle-header__sorted-by').innerHTML.indexOf('Low to High') > -1) {
			    isoTest.isLowHigh();
			} 
			else
			if ($('.vehicle-header__sorted-by').innerHTML.indexOf('High to Low') > -1) {
			    isoTest.isHighLow();
			}
		},
		events : function() {
			document.addEventListener('click', function (event) {
				/* Pills */
				var filters = ['Cars', 'SUVs', 'Unlimited Mileage'];
				for (var i = 0; i < filters.length; i++) {
					if (event.target.matches('[data-filter="'+filters[i]+'"]')) {
						$('input[value="'+filters[i]+'"]').click();
						if ($('input[value="'+filters[i]+'"]').checked === true ) {
							$('[data-filter="'+filters[i]+'"]').setAttribute('aria-selected','true');
							isoTest.fireTag('','Bubble Selected');
						} else {
							isoTest.fireTag('','Bubble Removed');
						}
					}
				}
				/* Sort */
				var current = $('.d-select-active');
				if (event.target.matches('.d-sort-select button')) {
					var currentValue = $('#vehicleSortBy').value;
					if (currentValue === 'Recommended') {
						isoTest.isFeatured();
					} else
					if (currentValue === 'Low to High') {
						isoTest.isLowHigh();
					}
					else
					if (currentValue === 'High to Low') {
						isoTest.isHighLow();
					}
					$('.d-sort-select').classList.toggle('d-sort-select-active');
					$('.d-sort-modal').classList.toggle('d-sort-active');
					$('.dsm-ok').focus();
					isoTest.fireTag('','Sort Dropdown Open');
				} else if (event.target.closest('.d-sort-modal')) {
					if (event.target.matches('.dsm-ok')) {
						$('.d-sort-modal').classList.toggle('d-sort-active');
						$('.d-sort-select-active').classList.remove('d-sort-select-active');
						if ($('.d-select-active').childNodes[0].classList.contains('dsm-feat')) {
							$('#vehicleSortBy').value = 'Recommended';
							isoTest.isFeatured();
						} else
						if ($('.d-select-active').childNodes[0].classList.contains('dsm-lth')) {
							$('#vehicleSortBy').value = 'Low to High';
							isoTest.isLowHigh();
						} else
						if ($('.d-select-active').childNodes[0].classList.contains('dsm-htl')) {
							$('#vehicleSortBy').value = 'High to Low';
							isoTest.isHighLow();
						}
						$('#vehicleSortBy').dispatchEvent(new Event('change', { 'bubbles': true }));
						isoTest.fireTag('','Sort Dropdown Submit');
					} else 
					if (event.target.matches('.dsm-down')) {
						if (current.nextElementSibling) {
							current.classList.remove('d-select-active');
							current.nextElementSibling.classList.add('d-select-active');
						}
					} else 
					if (event.target.matches('.dsm-up')) {
						if (current.previousElementSibling) {
							current.classList.remove('d-select-active');
							current.previousElementSibling.classList.add('d-select-active');
						}
					} else
					if (event.target.closest('li')) {
						current.classList.remove('d-select-active');
						event.target.closest('li').classList.add('d-select-active');
					}
				} else if ($('.d-sort-active')) {
					$('.d-sort-active').classList.remove('d-sort-active');
					$('.d-sort-select-active').classList.remove('d-sort-select-active');
				}		
			}, false);
		},
		isFeatured : function() {
			$$('.d-sort-modal li')[0].classList.add('d-select-active');
			$$('.d-sort-modal li')[1].classList.remove('d-select-active');
			$$('.d-sort-modal li')[2].classList.remove('d-select-active');
			$('.d-sort-select button').innerText = 'Featured';
		},
		isLowHigh : function() {
			$$('.d-sort-modal li')[0].classList.remove('d-select-active');
			$$('.d-sort-modal li')[1].classList.add('d-select-active');
			$$('.d-sort-modal li')[2].classList.remove('d-select-active');
			$('.d-sort-select button').innerText = 'Price Low to High';
		},
		isHighLow : function() {
			$$('.d-sort-modal li')[0].classList.remove('d-select-active');
			$$('.d-sort-modal li')[1].classList.remove('d-select-active');
			$$('.d-sort-modal li')[2].classList.add('d-select-active');
			$('.d-sort-select button').innerText = 'Price High to Low';
		},
		fireTag : function(element, value) {
			var linkName = value ? value : element.innerText;
				linkName = isoTest.test ? isoTest.test + ' : ' + linkName : linkName;
			s.linkTrackVars = 'eVar89';
			s.eVar89 = linkName;
			s.tl(this, 'o', linkName);
		},
		log : function(obj){
			if(isoTest.debug === true){
				console.log(obj);
			}
		}
	};

	var helpers = {
		elementLoaded : function (ele, callback) {
			isoTest.log('elementLoaded::  ' + ele + ' - Checking...');
			window.clearTimeout(isoTest.eleTimer);
			if (document.querySelectorAll(ele).length > 0) {
				if (typeof callback === 'function') {
					isoTest.log('elementLoaded::  ' + ele + ' - Found!');
					callback();
				}
	        } else {
	            isoTest.eleTimer = window.setTimeout(function(){helpers.elementLoaded(ele, callback);}, 100);
	        }
		},
	};
	var $ = document.querySelector.bind(document);
	var $$ = document.querySelectorAll.bind(document);
	isoTest.init();
})();
</script>